<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Branch / Staff Management - LynxLite</title>
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport" />
    <!-- Fonts and icons -->
    <script src="assets/js/plugin/webfont/webfont.min.js"></script>
    <script>
      WebFont.load({
        google: { families: ["Public Sans:300,400,500,600,700"] },
        custom: {
          families: [
            "Font Awesome 5 Solid",
            "Font Awesome 5 Regular", 
            "Font Awesome 5 Brands",
            "simple-line-icons",
          ],
          urls: ["assets/css/fonts.min.css"],
        },
        active: function () {
          sessionStorage.fonts = true;
        },
      });
    </script>
    <!-- CSS Files -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="assets/css/plugins.min.css" />
    <link rel="stylesheet" href="assets/css/lynxlite.min.css" />
    <link rel="stylesheet" href="assets/css/demo.css" />
    <link rel="stylesheet" href="assets/css/unified-custom.css" />
  </head>
  <body>
    <div class="wrapper">
      <!-- Sidebar -->
      <div class="sidebar" data-background-color="dark">
        <div class="sidebar-logo">
          <div class="logo-header" data-background-color="dark">
            <a href="index2.html" class="logo">
              <img src="assets/img/lynxlite/logo_light.svg" alt="LynxLite - Acacus" class="navbar-brand" height="45" />
            </a>
            <div class="nav-toggle">
              <button class="btn btn-toggle toggle-sidebar"><i class="gg-menu-right"></i></button>
              <button class="btn btn-toggle sidenav-toggler"><i class="gg-menu-left"></i></button>
            </div>
            <button class="topbar-toggler more"><i class="gg-more-vertical-alt"></i></button>
          </div>
        </div>
        <div class="sidebar-wrapper scrollbar scrollbar-inner">
          <div class="sidebar-content">
            <ul class="nav nav-secondary">
              <li class="nav-item">
                <a href="index2.html"><i class="fas fa-home"></i><p>Dashboard (Overview)</p></a>
              </li>
              <li class="nav-item">
                <a href="fleet-management.html"><i class="fas fa-car"></i><p>Fleet Management</p></a>
              </li>
              <li class="nav-item">
                <a href="booking-management.html"><i class="fas fa-calendar-alt"></i><p>Booking Management</p></a>
              </li>
              <li class="nav-item">
                <a href="customer-management.html"><i class="fas fa-users"></i><p>Customer Management</p></a>
              </li>
              <li class="nav-item">
                <a href="billing-payments.html"><i class="fas fa-credit-card"></i><p>Billing & Payments</p></a>
              </li>
              <li class="nav-item">
                <a href="maintenance-compliance.html"><i class="fas fa-wrench"></i><p>Maintenance & Compliance</p></a>
              </li>
              <li class="nav-item">
                <a href="telematics-tracking.html"><i class="fas fa-map-marked-alt"></i><p>Telematics & Tracking</p></a>
              </li>
              <li class="nav-item">
                <a href="reports-analytics.html"><i class="fas fa-chart-line"></i><p>Reports & Analytics</p></a>
              </li>
              <li class="nav-item active">
                <a href="branch-staff-management.html"><i class="fas fa-building"></i><p>Branch / Staff Management</p></a>
              </li>
              <li class="nav-item">
                <a href="#"><i class="fas fa-cogs"></i><p>System Settings</p></a>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <!-- End Sidebar -->
      
      <div class="main-panel">
        <div class="main-header">
          <div class="main-header-logo">
            <div class="logo-header" data-background-color="dark">
              <a href="index2.html" class="logo">
                <img src="assets/img/lynxlite/logo_light.svg" alt="LynxLite - Acacus" class="navbar-brand" height="20" />
              </a>
              <div class="nav-toggle">
                <button class="btn btn-toggle toggle-sidebar"><i class="gg-menu-right"></i></button>
                <button class="btn btn-toggle sidenav-toggler"><i class="gg-menu-left"></i></button>
              </div>
              <button class="topbar-toggler more"><i class="gg-more-vertical-alt"></i></button>
            </div>
          </div>
          <!-- Navbar Header -->
          <nav class="navbar navbar-header navbar-header-transparent navbar-expand-lg border-bottom">
            <div class="container-fluid">
              <nav class="navbar navbar-header-left navbar-expand-lg navbar-form nav-search p-0 d-none d-lg-flex">
                <div class="input-group">
                  <div class="input-group-prepend">
                    <button type="submit" class="btn btn-search pe-1">
                      <i class="fa fa-search search-icon"></i>
                    </button>
                  </div>
                  <input type="text" placeholder="Search branches, staff..." class="form-control" id="globalSearch" />
                </div>
              </nav>
              <ul class="navbar-nav topbar-nav ms-md-auto align-items-center">
                <li class="nav-item d-flex align-items-center">
                  <div class="form-check form-switch mb-0 ms-2">
                    <input class="form-check-input" type="checkbox" id="darkModeSwitch" />
                    <label class="form-check-label" for="darkModeSwitch" style="color:inherit;">Dark Mode</label>
                  </div>
                </li>
                <li class="nav-item topbar-icon dropdown hidden-caret d-flex d-lg-none">
                  <a class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false" aria-haspopup="true">
                    <i class="fa fa-search"></i>
                  </a>
                  <ul class="dropdown-menu dropdown-search animated fadeIn">
                    <form class="navbar-left navbar-form nav-search">
                      <div class="input-group">
                        <input type="text" placeholder="Search branches, staff..." class="form-control" />
                      </div>
                    </form>
                  </ul>
                </li>
                <li class="nav-item topbar-icon dropdown hidden-caret">
                  <a class="nav-link dropdown-toggle" href="#" id="messageDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <i class="fa fa-envelope"></i>
                  </a>
                  <ul class="dropdown-menu messages-notif-box animated fadeIn" aria-labelledby="messageDropdown">
                    <li>
                      <div class="dropdown-title d-flex justify-content-between align-items-center">Messages <a href="#" class="small">Mark all as read</a></div>
                    </li>
                    <li>
                      <div class="message-notif-scroll scrollbar-outer">
                        <div class="notif-center">
                          <a href="#"><div class="notif-img"><i class="fas fa-user-circle fa-2x"></i></div><div class="notif-content"><span class="subject">New Staff Member</span><span class="block">John Doe added to Manhattan branch</span><span class="time">10 minutes ago</span></div></a>
                        </div>
                      </div>
                    </li>
                    <li><a class="see-all" href="javascript:void(0);">See all messages<i class="fa fa-angle-right"></i></a></li>
                  </ul>
                </li>
                <li class="nav-item topbar-icon dropdown hidden-caret">
                  <a class="nav-link dropdown-toggle" href="#" id="notifDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <i class="fa fa-bell"></i><span class="notification">3</span>
                  </a>
                  <ul class="dropdown-menu notif-box animated fadeIn" aria-labelledby="notifDropdown">
                    <li><div class="dropdown-title">You have 3 new notifications</div></li>
                    <li>
                      <div class="notif-scroll scrollbar-outer">
                        <div class="notif-center">
                          <a href="#" class="notif-item"><div class="notif-icon notif-success"><i class="fas fa-user-plus"></i></div><div class="notif-content"><span class="block">Staff member activated</span><span class="time">5 minutes ago</span></div></a>
                          <a href="#" class="notif-item"><div class="notif-icon notif-warning"><i class="fas fa-building"></i></div><div class="notif-content"><span class="block">Branch capacity reached</span><span class="time">30 minutes ago</span></div></a>
                          <a href="#" class="notif-item"><div class="notif-icon notif-info"><i class="fas fa-shield-alt"></i></div><div class="notif-content"><span class="block">Permission updated</span><span class="time">1 hour ago</span></div></a>
                        </div>
                      </div>
                    </li>
                    <li><a class="see-all" href="javascript:void(0);">See all notifications<i class="fa fa-angle-right"></i></a></li>
                  </ul>
                </li>
                <li class="nav-item topbar-icon dropdown hidden-caret">
                  <a class="nav-link" data-bs-toggle="dropdown" href="#" aria-expanded="false"><i class="fas fa-layer-group"></i></a>
                  <div class="dropdown-menu quick-actions animated fadeIn">
                    <div class="quick-actions-header"><span class="title mb-1">Quick Actions</span><span class="subtitle op-7">Shortcuts</span></div>
                    <div class="quick-actions-scroll scrollbar-outer">
                      <div class="quick-actions-items">
                        <div class="row m-0">
                          <a class="col-6 col-md-4 p-0" href="fleet-management.html"><div class="quick-actions-item"><div class="avatar-item bg-primary rounded-circle"><i class="fas fa-car"></i></div><span class="text">Fleet</span></div></a>
                          <a class="col-6 col-md-4 p-0" href="booking-management.html"><div class="quick-actions-item"><div class="avatar-item bg-danger rounded-circle"><i class="far fa-calendar-alt"></i></div><span class="text">Bookings</span></div></a>
                          <a class="col-6 col-md-4 p-0" href="customer-management.html"><div class="quick-actions-item"><div class="avatar-item bg-success rounded-circle"><i class="fas fa-users"></i></div><span class="text">Customers</span></div></a>
                          <a class="col-6 col-md-4 p-0" href="billing-payments.html"><div class="quick-actions-item"><div class="avatar-item bg-warning rounded-circle"><i class="fas fa-credit-card"></i></div><span class="text">Payments</span></div></a>
                          <a class="col-6 col-md-4 p-0" href="maintenance-compliance.html"><div class="quick-actions-item"><div class="avatar-item bg-info rounded-circle"><i class="fas fa-wrench"></i></div><span class="text">Maintenance</span></div></a>
                          <a class="col-6 col-md-4 p-0" href="telematics-tracking.html"><div class="quick-actions-item"><div class="avatar-item bg-secondary rounded-circle"><i class="fas fa-map"></i></div><span class="text">Tracking</span></div></a>
                        </div>
                      </div>
                    </div>
                  </div>
                </li>
                <li class="nav-item topbar-user dropdown hidden-caret">
                  <a class="dropdown-toggle profile-pic" data-bs-toggle="dropdown" href="#" aria-expanded="false">
                    <div class="avatar-sm"><i class="fas fa-user-circle fa-2x"></i></div>
                    <span class="profile-username"><span class="op-7">Hi,</span> <span class="fw-bold">Admin</span></span>
                  </a>
                  <ul class="dropdown-menu dropdown-user animated fadeIn">
                    <div class="dropdown-user-scroll scrollbar-outer">
                      <li>
                        <div class="user-box">
                          <div class="avatar-lg"><i class="fas fa-user-circle fa-3x"></i></div>
                          <div class="u-text">
                            <h4>Admin</h4>
                            <p class="text-muted">hello@example.com</p>
                            <a href="profile.html" class="btn btn-xs btn-secondary btn-sm">View Profile</a>
                          </div>
                        </div>
                      </li>
                      <li>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="#">My Profile</a>
                        <a class="dropdown-item" href="#">My Balance</a>
                        <a class="dropdown-item" href="#">Inbox</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="#">Account Setting</a>
                        <a class="dropdown-item" href="#">Logout</a>
                      </li>
                    </div>
                  </ul>
                </li>
              </ul>
            </div>
          </nav>
          
        </div>
        
        <!-- Branch / Staff Management Content -->
        <div class="container">
          <div class="page-inner">
            <!-- Quick Stats Cards -->
            <div class="row mb-4">
              <div class="col-sm-6 col-md-3">
                <div class="card card-stats card-round">
                  <div class="card-body">
                    <div class="row align-items-center">
                      <div class="col-icon">
                        <div class="icon-big text-center icon-primary bubble-shadow-small">
                          <i class="fas fa-building"></i>
                        </div>
                      </div>
                      <div class="col col-stats ms-3">
                        <div class="numbers">
                          <p class="card-category">Total Branches</p>
                          <h4 class="card-title">4</h4>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-6 col-md-3">
                <div class="card card-stats card-round">
                  <div class="card-body">
                    <div class="row align-items-center">
                      <div class="col-icon">
                        <div class="icon-big text-center icon-success bubble-shadow-small">
                          <i class="fas fa-users"></i>
                        </div>
                      </div>
                      <div class="col col-stats ms-3">
                        <div class="numbers">
                          <p class="card-category">Total Staff</p>
                          <h4 class="card-title">28</h4>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-6 col-md-3">
                <div class="card card-stats card-round">
                  <div class="card-body">
                    <div class="row align-items-center">
                      <div class="col-icon">
                        <div class="icon-big text-center icon-warning bubble-shadow-small">
                          <i class="fas fa-user-shield"></i>
                        </div>
                      </div>
                      <div class="col col-stats ms-3">
                        <div class="numbers">
                          <p class="card-category">Active Roles</p>
                          <h4 class="card-title">6</h4>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-6 col-md-3">
                <div class="card card-stats card-round">
                  <div class="card-body">
                    <div class="row align-items-center">
                      <div class="col-icon">
                        <div class="icon-big text-center icon-info bubble-shadow-small">
                          <i class="fas fa-shield-alt"></i>
                        </div>
                      </div>
                      <div class="col col-stats ms-3">
                        <div class="numbers">
                          <p class="card-category">Permission Groups</p>
                          <h4 class="card-title">12</h4>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Navigation Tabs -->
            <div class="row">
              <div class="col-md-12">
                <div class="card">
                  <div class="card-body">
                    <ul class="nav nav-pills nav-pills-success" id="managementTabs" role="tablist">
                      <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="branches-tab" data-bs-toggle="pill" data-bs-target="#branches" role="tab">
                          <i class="fas fa-building me-2"></i>Branches
                        </button>
                      </li>
                      <li class="nav-item" role="presentation">
                        <button class="nav-link" id="staff-tab" data-bs-toggle="pill" data-bs-target="#staff" role="tab">
                          <i class="fas fa-users me-2"></i>Staff
                        </button>
                      </li>
                      <li class="nav-item" role="presentation">
                        <button class="nav-link" id="performance-tab" data-bs-toggle="pill" data-bs-target="#performance" role="tab">
                          <i class="fas fa-chart-line me-2"></i>Performance
                        </button>
                      </li>
                      <li class="nav-item" role="presentation">
                        <button class="nav-link" id="scheduling-tab" data-bs-toggle="pill" data-bs-target="#scheduling" role="tab">
                          <i class="fas fa-calendar me-2"></i>Scheduling
                        </button>
                      </li>
                      <li class="nav-item" role="presentation">
                        <button class="nav-link" id="training-tab" data-bs-toggle="pill" data-bs-target="#training" role="tab">
                          <i class="fas fa-graduation-cap me-2"></i>Training
                        </button>
                      </li>
                      <li class="nav-item" role="presentation">
                        <button class="nav-link" id="communication-tab" data-bs-toggle="pill" data-bs-target="#communication" role="tab">
                          <i class="fas fa-comments me-2"></i>Communication
                        </button>
                      </li>
                      <li class="nav-item" role="presentation">
                        <button class="nav-link" id="security-tab" data-bs-toggle="pill" data-bs-target="#security" role="tab">
                          <i class="fas fa-shield-alt me-2"></i>Security
                        </button>
                      </li>
                      <li class="nav-item" role="presentation">
                        <button class="nav-link" id="roles-tab" data-bs-toggle="pill" data-bs-target="#roles" role="tab">
                          <i class="fas fa-user-shield me-2"></i>Roles
                        </button>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>

            <!-- Tab Content -->
            <div class="tab-content">
              <!-- Branch Locations Tab -->
              <div class="tab-pane fade show active" id="branches" role="tabpanel">
                <div class="row">
                  <div class="col-md-12">
                    <div class="card">
                      <div class="card-header">
                        <div class="d-flex align-items-center justify-content-between">
                          <h4 class="card-title"><i class="fas fa-building me-2"></i>Branch Locations</h4>
                          <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addBranchModal">
                            <i class="fas fa-plus"></i> Add Branch
                          </button>
                        </div>
                      </div>
                      <div class="card-body">
                        <div class="table-responsive">
                          <table class="table table-hover">
                            <thead>
                              <tr>
                                <th>Branch Name</th>
                                <th>Address</th>
                                <th>Contact Info</th>
                                <th>Capacity</th>
                                <th>Staff Count</th>
                                <th>Status</th>
                                <th>Actions</th>
                              </tr>
                            </thead>
                            <tbody id="branchesTableBody">
                              <!-- Populated by JavaScript -->
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Branch Details Cards -->
                <div class="row mt-4">
                  <div class="col-md-6">
                    <div class="card">
                      <div class="card-header">
                        <h5 class="card-title mb-0"><i class="fas fa-chart-pie me-2"></i>Branch Performance</h5>
                      </div>
                      <div class="card-body">
                        <div id="branchPerformanceList">
                          <!-- Populated by JavaScript -->
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <div class="col-md-6">
                    <div class="card">
                      <div class="card-header">
                        <h5 class="card-title mb-0"><i class="fas fa-map-marker-alt me-2"></i>Branch Coverage Map</h5>
                      </div>
                      <div class="card-body text-center">
                        <div style="height: 200px; background: #f8f9fa; border: 2px dashed #dee2e6; display: flex; align-items: center; justify-content: center;">
                          <div>
                            <i class="fas fa-map-marked-alt fa-3x text-muted mb-2"></i>
                            <p class="text-muted">Interactive branch location map</p>
                            <small class="text-muted">Would integrate with mapping service</small>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Staff Management Tab -->
              <div class="tab-pane fade" id="staff" role="tabpanel">
                <div class="row">
                  <div class="col-md-8">
                    <div class="card">
                      <div class="card-header">
                        <div class="d-flex align-items-center justify-content-between">
                          <h4 class="card-title"><i class="fas fa-users me-2"></i>Staff Directory</h4>
                          <div>
                            <button class="btn btn-outline-success btn-sm me-2" onclick="exportStaffList()">
                              <i class="fas fa-download"></i> Export
                            </button>
                            <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#addStaffModal">
                              <i class="fas fa-user-plus"></i> Add Staff
                            </button>
                          </div>
                        </div>
                      </div>
                      <div class="card-body">
                        <!-- Staff Filters -->
                        <div class="row mb-3">
                          <div class="col-md-3">
                            <select class="form-select form-select-sm" id="filterBranch">
                              <option value="">All Branches</option>
                              <option value="manhattan">Manhattan</option>
                              <option value="brooklyn">Brooklyn</option>
                              <option value="queens">Queens</option>
                              <option value="bronx">Bronx</option>
                            </select>
                          </div>
                          <div class="col-md-3">
                            <select class="form-select form-select-sm" id="filterRole">
                              <option value="">All Roles</option>
                              <option value="admin">Admin</option>
                              <option value="manager">Manager</option>
                              <option value="dispatcher">Dispatcher</option>
                              <option value="accountant">Accountant</option>
                              <option value="mechanic">Mechanic</option>
                            </select>
                          </div>
                          <div class="col-md-3">
                            <select class="form-select form-select-sm" id="filterStatus">
                              <option value="">All Status</option>
                              <option value="active">Active</option>
                              <option value="inactive">Inactive</option>
                              <option value="suspended">Suspended</option>
                            </select>
                          </div>
                          <div class="col-md-3">
                            <input type="text" class="form-control form-control-sm" placeholder="Search staff..." id="staffSearch">
                          </div>
                        </div>

                        <div class="table-responsive">
                          <table class="table table-hover">
                            <thead>
                              <tr>
                                <th>Staff Member</th>
                                <th>Role</th>
                                <th>Branch</th>
                                <th>Contact</th>
                                <th>Status</th>
                                <th>Last Login</th>
                                <th>Actions</th>
                              </tr>
                            </thead>
                            <tbody id="staffTableBody">
                              <!-- Populated by JavaScript -->
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <div class="col-md-4">
                    <!-- Staff Statistics -->
                    <div class="card">
                      <div class="card-header">
                        <h5 class="card-title mb-0"><i class="fas fa-chart-bar me-2"></i>Staff Overview</h5>
                      </div>
                      <div class="card-body">
                        <div class="mb-3">
                          <div class="d-flex justify-content-between">
                            <span>Active Staff</span>
                            <strong class="text-success">24</strong>
                          </div>
                          <div class="progress mt-1" style="height: 6px;">
                            <div class="progress-bar bg-success" style="width: 86%"></div>
                          </div>
                        </div>
                        <div class="mb-3">
                          <div class="d-flex justify-content-between">
                            <span>On Leave</span>
                            <strong class="text-warning">3</strong>
                          </div>
                          <div class="progress mt-1" style="height: 6px;">
                            <div class="progress-bar bg-warning" style="width: 10%"></div>
                          </div>
                        </div>
                        <div class="mb-3">
                          <div class="d-flex justify-content-between">
                            <span>Suspended</span>
                            <strong class="text-danger">1</strong>
                          </div>
                          <div class="progress mt-1" style="height: 6px;">
                            <div class="progress-bar bg-danger" style="width: 4%"></div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <!-- Recent Activities -->
                    <div class="card mt-3">
                      <div class="card-header">
                        <h5 class="card-title mb-0"><i class="fas fa-clock me-2"></i>Recent Activities</h5>
                      </div>
                      <div class="card-body">
                        <div class="timeline" id="staffActivities">
                          <div class="timeline-item">
                            <div class="timeline-marker bg-success"></div>
                            <div class="timeline-content">
                              <h6 class="mb-1">John Doe logged in</h6>
                              <p class="text-muted mb-1">Manhattan branch</p>
                              <small class="text-muted">5 minutes ago</small>
                            </div>
                          </div>
                          <div class="timeline-item">
                            <div class="timeline-marker bg-info"></div>
                            <div class="timeline-content">
                              <h6 class="mb-1">Sarah Johnson updated</h6>
                              <p class="text-muted mb-1">Role changed to Manager</p>
                              <small class="text-muted">1 hour ago</small>
                            </div>
                          </div>
                          <div class="timeline-item">
                            <div class="timeline-marker bg-warning"></div>
                            <div class="timeline-content">
                              <h6 class="mb-1">Mike Davis on leave</h6>
                              <p class="text-muted mb-1">Vacation until Dec 20</p>
                              <small class="text-muted">2 hours ago</small>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Performance Analytics Tab -->
              <div class="tab-pane fade" id="performance" role="tabpanel">
                <div class="row">
                  <div class="col-md-8">
                    <div class="card">
                      <div class="card-header">
                        <h4 class="card-title"><i class="fas fa-chart-line me-2"></i>Branch Performance Dashboard</h4>
                      </div>
                      <div class="card-body">
                        <canvas id="branchPerformanceChart" height="80"></canvas>
                      </div>
                    </div>
                  </div>
                  
                  <div class="col-md-4">
                    <!-- Real-Time Monitoring -->
                    <div class="card">
                      <div class="card-header">
                        <h5 class="card-title mb-0"><i class="fas fa-pulse me-2"></i>Live Monitoring</h5>
                      </div>
                      <div class="card-body">
                        <div class="mb-3">
                          <div class="d-flex justify-content-between">
                            <span>Staff Online</span>
                            <strong class="text-success" id="staffOnlineCount">18/28</strong>
                          </div>
                          <div class="progress mt-1" style="height: 6px;">
                            <div class="progress-bar bg-success" style="width: 64%"></div>
                          </div>
                        </div>
                        <div class="mb-3">
                          <div class="d-flex justify-content-between">
                            <span>Branch Capacity</span>
                            <strong class="text-warning" id="totalCapacity">119/150</strong>
                          </div>
                          <div class="progress mt-1" style="height: 6px;">
                            <div class="progress-bar bg-warning" style="width: 79%"></div>
                          </div>
                        </div>
                        <div class="mb-3">
                          <div class="d-flex justify-content-between">
                            <span>Active Alerts</span>
                            <strong class="text-danger" id="activeAlertsCount">3</strong>
                          </div>
                        </div>
                        <button class="btn btn-primary btn-sm w-100" onclick="showRealTimeMonitoring()">
                          <i class="fas fa-eye"></i> View Live Dashboard
                        </button>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Staff Productivity Metrics -->
                <div class="row mt-4">
                  <div class="col-md-12">
                    <div class="card">
                      <div class="card-header">
                        <h4 class="card-title"><i class="fas fa-users-cog me-2"></i>Staff Productivity Metrics</h4>
                      </div>
                      <div class="card-body">
                        <div class="table-responsive">
                          <table class="table table-hover">
                            <thead>
                              <tr>
                                <th>Staff Member</th>
                                <th>Bookings Processed</th>
                                <th>Customer Rating</th>
                                <th>Revenue Generated</th>
                                <th>Efficiency Score</th>
                                <th>Workload</th>
                                <th>Performance</th>
                              </tr>
                            </thead>
                            <tbody id="staffProductivityTable">
                              <!-- Populated by JavaScript -->
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Scheduling & Planning Tab -->
              <div class="tab-pane fade" id="scheduling" role="tabpanel">
                <div class="row">
                  <div class="col-md-8">
                    <div class="card">
                      <div class="card-header">
                        <div class="d-flex align-items-center justify-content-between">
                          <h4 class="card-title"><i class="fas fa-calendar-alt me-2"></i>Staff Scheduling System</h4>
                          <div>
                            <button class="btn btn-outline-success btn-sm me-2" onclick="optimizeSchedule()">
                              <i class="fas fa-magic"></i> Optimize
                            </button>
                            <button class="btn btn-primary btn-sm" onclick="createShift()">
                              <i class="fas fa-plus"></i> Create Shift
                            </button>
                          </div>
                        </div>
                      </div>
                      <div class="card-body">
                        <div class="schedule-calendar" id="scheduleCalendar">
                          <div class="table-responsive">
                            <table class="table table-bordered">
                              <thead>
                                <tr>
                                  <th>Time</th>
                                  <th>Monday</th>
                                  <th>Tuesday</th>
                                  <th>Wednesday</th>
                                  <th>Thursday</th>
                                  <th>Friday</th>
                                  <th>Saturday</th>
                                  <th>Sunday</th>
                                </tr>
                              </thead>
                              <tbody id="scheduleTableBody">
                                <!-- Populated by JavaScript -->
                              </tbody>
                            </table>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <div class="col-md-4">
                    <!-- Scheduling Analytics -->
                    <div class="card">
                      <div class="card-header">
                        <h5 class="card-title mb-0"><i class="fas fa-chart-bar me-2"></i>Scheduling Analytics</h5>
                      </div>
                      <div class="card-body">
                        <div class="mb-3">
                          <div class="d-flex justify-content-between">
                            <span>Coverage Rate</span>
                            <strong class="text-success">94%</strong>
                          </div>
                          <div class="progress mt-1" style="height: 6px;">
                            <div class="progress-bar bg-success" style="width: 94%"></div>
                          </div>
                        </div>
                        <div class="mb-3">
                          <div class="d-flex justify-content-between">
                            <span>Overtime Hours</span>
                            <strong class="text-warning">24 hrs</strong>
                          </div>
                        </div>
                        <div class="mb-3">
                          <div class="d-flex justify-content-between">
                            <span>Staff on Leave</span>
                            <strong class="text-info">3 people</strong>
                          </div>
                        </div>
                      </div>
                    </div>

                    <!-- Leave Management -->
                    <div class="card mt-3">
                      <div class="card-header">
                        <h5 class="card-title mb-0"><i class="fas fa-calendar-times me-2"></i>Leave Management</h5>
                      </div>
                      <div class="card-body">
                        <div id="leaveRequestsList">
                          <!-- Populated by JavaScript -->
                        </div>
                        <button class="btn btn-outline-primary btn-sm w-100 mt-2" onclick="manageLeaveRequests()">
                          <i class="fas fa-list"></i> View All Requests
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Training & Development Tab -->
              <div class="tab-pane fade" id="training" role="tabpanel">
                <div class="row">
                  <div class="col-md-8">
                    <div class="card">
                      <div class="card-header">
                        <div class="d-flex align-items-center justify-content-between">
                          <h4 class="card-title"><i class="fas fa-graduation-cap me-2"></i>Training Programs</h4>
                          <button class="btn btn-primary btn-sm" onclick="createTrainingModule()">
                            <i class="fas fa-plus"></i> New Module
                          </button>
                        </div>
                      </div>
                      <div class="card-body">
                        <div class="table-responsive">
                          <table class="table table-hover">
                            <thead>
                              <tr>
                                <th>Training Module</th>
                                <th>Completion Rate</th>
                                <th>Avg Score</th>
                                <th>Required For</th>
                                <th>Next Session</th>
                                <th>Actions</th>
                              </tr>
                            </thead>
                            <tbody id="trainingModulesTable">
                              <!-- Populated by JavaScript -->
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <div class="col-md-4">
                    <!-- Training Analytics -->
                    <div class="card">
                      <div class="card-header">
                        <h5 class="card-title mb-0"><i class="fas fa-chart-pie me-2"></i>Training Analytics</h5>
                      </div>
                      <div class="card-body">
                        <canvas id="trainingCompletionChart" height="200"></canvas>
                      </div>
                    </div>

                    <!-- Certification Tracking -->
                    <div class="card mt-3">
                      <div class="card-header">
                        <h5 class="card-title mb-0"><i class="fas fa-certificate me-2"></i>Certifications</h5>
                      </div>
                      <div class="card-body">
                        <div id="certificationsList">
                          <!-- Populated by JavaScript -->
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Staff Development -->
                <div class="row mt-4">
                  <div class="col-md-12">
                    <div class="card">
                      <div class="card-header">
                        <h4 class="card-title"><i class="fas fa-user-graduate me-2"></i>Staff Development & Performance Reviews</h4>
                      </div>
                      <div class="card-body">
                        <div class="table-responsive">
                          <table class="table table-hover">
                            <thead>
                              <tr>
                                <th>Staff Member</th>
                                <th>Current Level</th>
                                <th>Training Progress</th>
                                <th>Performance Score</th>
                                <th>Next Review</th>
                                <th>Career Path</th>
                                <th>Actions</th>
                              </tr>
                            </thead>
                            <tbody id="staffDevelopmentTable">
                              <!-- Populated by JavaScript -->
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Communication & Collaboration Tab -->
              <div class="tab-pane fade" id="communication" role="tabpanel">
                <div class="row">
                  <div class="col-md-6">
                    <div class="card">
                      <div class="card-header">
                        <div class="d-flex align-items-center justify-content-between">
                          <h4 class="card-title"><i class="fas fa-bullhorn me-2"></i>Company Announcements</h4>
                          <button class="btn btn-primary btn-sm" onclick="createAnnouncement()">
                            <i class="fas fa-plus"></i> New Announcement
                          </button>
                        </div>
                      </div>
                      <div class="card-body">
                        <div id="announcementsList">
                          <!-- Populated by JavaScript -->
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <div class="col-md-6">
                    <div class="card">
                      <div class="card-header">
                        <h4 class="card-title"><i class="fas fa-tasks me-2"></i>Task Management</h4>
                      </div>
                      <div class="card-body">
                        <div class="mb-3">
                          <button class="btn btn-success btn-sm" onclick="createTask()">
                            <i class="fas fa-plus"></i> Assign Task
                          </button>
                        </div>
                        <div id="tasksList">
                          <!-- Populated by JavaScript -->
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Internal Messaging -->
                <div class="row mt-4">
                  <div class="col-md-12">
                    <div class="card">
                      <div class="card-header">
                        <h4 class="card-title"><i class="fas fa-comments me-2"></i>Internal Messaging System</h4>
                      </div>
                      <div class="card-body">
                        <div class="row">
                          <div class="col-md-4">
                            <h6>Active Conversations</h6>
                            <div id="conversationsList">
                              <!-- Populated by JavaScript -->
                            </div>
                          </div>
                          <div class="col-md-8">
                            <div class="messaging-area border rounded p-3" style="height: 300px; background: #f8f9fa;">
                              <div class="text-center text-muted">
                                <i class="fas fa-comments fa-3x mb-2"></i>
                                <p>Select a conversation to start messaging</p>
                              </div>
                            </div>
                            <div class="mt-2">
                              <div class="input-group">
                                <input type="text" class="form-control" placeholder="Type a message...">
                                <button class="btn btn-primary" type="button">
                                  <i class="fas fa-paper-plane"></i>
                                </button>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Security & Audit Tab -->
              <div class="tab-pane fade" id="security" role="tabpanel">
                <div class="row">
                  <div class="col-md-6">
                    <div class="card">
                      <div class="card-header">
                        <h4 class="card-title"><i class="fas fa-shield-alt me-2"></i>Security Settings</h4>
                      </div>
                      <div class="card-body">
                        <div class="security-setting mb-3">
                          <div class="d-flex justify-content-between align-items-center">
                            <div>
                              <h6 class="mb-1">Two-Factor Authentication</h6>
                              <p class="text-muted mb-0">Require 2FA for all admin accounts</p>
                            </div>
                            <div class="form-check form-switch">
                              <input class="form-check-input" type="checkbox" id="enable2FA" checked>
                            </div>
                          </div>
                        </div>
                        <div class="security-setting mb-3">
                          <div class="d-flex justify-content-between align-items-center">
                            <div>
                              <h6 class="mb-1">Session Timeout</h6>
                              <p class="text-muted mb-0">Auto-logout after inactivity</p>
                            </div>
                            <select class="form-select form-select-sm" style="width: 120px;">
                              <option>30 minutes</option>
                              <option>1 hour</option>
                              <option>2 hours</option>
                              <option>4 hours</option>
                            </select>
                          </div>
                        </div>
                        <div class="security-setting mb-3">
                          <div class="d-flex justify-content-between align-items-center">
                            <div>
                              <h6 class="mb-1">IP Restrictions</h6>
                              <p class="text-muted mb-0">Limit access by IP address</p>
                            </div>
                            <button class="btn btn-outline-primary btn-sm" onclick="manageIPRestrictions()">
                              <i class="fas fa-cog"></i> Configure
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <div class="col-md-6">
                    <div class="card">
                      <div class="card-header">
                        <h4 class="card-title"><i class="fas fa-history me-2"></i>Activity Audit Trail</h4>
                      </div>
                      <div class="card-body">
                        <div id="auditTrailList" style="height: 300px; overflow-y: auto;">
                          <!-- Populated by JavaScript -->
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Security Alerts -->
                <div class="row mt-4">
                  <div class="col-md-12">
                    <div class="card">
                      <div class="card-header">
                        <h4 class="card-title"><i class="fas fa-exclamation-triangle me-2"></i>Security Alerts & Monitoring</h4>
                      </div>
                      <div class="card-body">
                        <div class="table-responsive">
                          <table class="table table-hover">
                            <thead>
                              <tr>
                                <th>Alert Type</th>
                                <th>Description</th>
                                <th>User/IP</th>
                                <th>Timestamp</th>
                                <th>Severity</th>
                                <th>Status</th>
                                <th>Actions</th>
                              </tr>
                            </thead>
                            <tbody id="securityAlertsTable">
                              <!-- Populated by JavaScript -->
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Roles & Permissions Tab -->
              <div class="tab-pane fade" id="roles" role="tabpanel">
                <div class="row">
                  <div class="col-md-6">
                    <div class="card">
                      <div class="card-header">
                        <div class="d-flex align-items-center justify-content-between">
                          <h4 class="card-title"><i class="fas fa-user-shield me-2"></i>User Roles</h4>
                          <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#addRoleModal">
                            <i class="fas fa-plus"></i> Add Role
                          </button>
                        </div>
                      </div>
                      <div class="card-body">
                        <div id="rolesContainer">
                          <!-- Populated by JavaScript -->
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <div class="col-md-6">
                    <div class="card">
                      <div class="card-header">
                        <h4 class="card-title"><i class="fas fa-shield-alt me-2"></i>Permission Matrix</h4>
                      </div>
                      <div class="card-body">
                        <div class="table-responsive">
                          <table class="table table-sm">
                            <thead>
                              <tr>
                                <th>Module</th>
                                <th>Admin</th>
                                <th>Manager</th>
                                <th>Dispatcher</th>
                                <th>Accountant</th>
                                <th>Mechanic</th>
                              </tr>
                            </thead>
                            <tbody id="permissionMatrix">
                              <!-- Populated by JavaScript -->
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- RBAC Configuration -->
                <div class="row mt-4">
                  <div class="col-md-12">
                    <div class="card">
                      <div class="card-header">
                        <h4 class="card-title"><i class="fas fa-cogs me-2"></i>Role-Based Access Control (RBAC) Configuration</h4>
                      </div>
                      <div class="card-body">
                        <div class="row">
                          <div class="col-md-4">
                            <h6>System Modules</h6>
                            <div class="module-list" id="modulesList">
                              <!-- Populated by JavaScript -->
                            </div>
                          </div>
                          <div class="col-md-4">
                            <h6>Available Permissions</h6>
                            <div class="permissions-list" id="permissionsList">
                              <!-- Populated by JavaScript -->
                            </div>
                          </div>
                          <div class="col-md-4">
                            <h6>Role Assignment</h6>
                            <div class="role-assignment" id="roleAssignment">
                              <button class="btn btn-success btn-sm" onclick="saveRBACConfiguration()">
                                <i class="fas fa-save"></i> Save Configuration
                              </button>
                              <button class="btn btn-warning btn-sm ms-2" onclick="resetRBACConfiguration()">
                                <i class="fas fa-undo"></i> Reset
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Add Branch Modal -->
    <div class="modal fade" id="addBranchModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Add New Branch</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <form id="addBranchForm">
              <div class="row">
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label">Branch Name *</label>
                    <input type="text" class="form-control" id="branchName" placeholder="e.g. Manhattan Central" required>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Branch Code *</label>
                    <input type="text" class="form-control" id="branchCode" placeholder="e.g. MAN-01" required>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Manager *</label>
                    <select class="form-select" id="branchManager" required>
                      <option value="">Select Manager</option>
                      <option value="john-doe">John Doe</option>
                      <option value="sarah-johnson">Sarah Johnson</option>
                      <option value="mike-davis">Mike Davis</option>
                    </select>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Vehicle Capacity *</label>
                    <input type="number" class="form-control" id="vehicleCapacity" placeholder="50" min="1" required>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label">Address *</label>
                    <textarea class="form-control" id="branchAddress" rows="3" placeholder="Full address..." required></textarea>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Phone Number *</label>
                    <input type="tel" class="form-control" id="branchPhone" placeholder="+1 (555) 123-4567" required>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Email *</label>
                    <input type="email" class="form-control" id="branchEmail" placeholder="branch@example.com" required>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Operating Hours</label>
                    <input type="text" class="form-control" id="operatingHours" placeholder="e.g. Mon-Fri: 8AM-6PM">
                  </div>
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-primary" onclick="addBranch()">
              <i class="fas fa-plus"></i> Add Branch
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Add Staff Modal -->
    <div class="modal fade" id="addStaffModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Add New Staff Member</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <form id="addStaffForm">
              <div class="row">
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label">Full Name *</label>
                    <input type="text" class="form-control" id="staffName" placeholder="John Doe" required>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Email *</label>
                    <input type="email" class="form-control" id="staffEmail" placeholder="john.doe@example.com" required>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Phone Number *</label>
                    <input type="tel" class="form-control" id="staffPhone" placeholder="+1 (555) 123-4567" required>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Employee ID *</label>
                    <input type="text" class="form-control" id="employeeId" placeholder="EMP-001" required>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label">Role *</label>
                    <select class="form-select" id="staffRole" required>
                      <option value="">Select Role</option>
                      <option value="admin">Admin</option>
                      <option value="manager">Manager</option>
                      <option value="dispatcher">Dispatcher</option>
                      <option value="accountant">Accountant</option>
                      <option value="mechanic">Mechanic</option>
                      <option value="customer-service">Customer Service</option>
                    </select>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Branch *</label>
                    <select class="form-select" id="staffBranch" required>
                      <option value="">Select Branch</option>
                      <option value="manhattan">Manhattan</option>
                      <option value="brooklyn">Brooklyn</option>
                      <option value="queens">Queens</option>
                      <option value="bronx">Bronx</option>
                    </select>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Start Date *</label>
                    <input type="date" class="form-control" id="startDate" required>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Salary</label>
                    <input type="number" class="form-control" id="salary" placeholder="50000" step="1000">
                  </div>
                </div>
              </div>
              <div class="mb-3">
                <div class="form-check form-switch">
                  <input class="form-check-input" type="checkbox" id="sendWelcomeEmail" checked>
                  <label class="form-check-label" for="sendWelcomeEmail">Send welcome email with login credentials</label>
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-primary" onclick="addStaff()">
              <i class="fas fa-user-plus"></i> Add Staff
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Add Role Modal -->
    <div class="modal fade" id="addRoleModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Create New Role</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <form id="addRoleForm">
              <div class="mb-3">
                <label class="form-label">Role Name *</label>
                <input type="text" class="form-control" id="roleName" placeholder="e.g. Senior Manager" required>
              </div>
              <div class="mb-3">
                <label class="form-label">Role Description</label>
                <textarea class="form-control" id="roleDescription" rows="3" placeholder="Brief description of role responsibilities"></textarea>
              </div>
              <div class="mb-3">
                <label class="form-label">Base Permissions</label>
                <select class="form-select" id="basePermissions">
                  <option value="minimal">Minimal Access</option>
                  <option value="standard">Standard User</option>
                  <option value="advanced">Advanced User</option>
                  <option value="admin">Administrative</option>
                </select>
              </div>
              <div class="mb-3">
                <div class="form-check form-switch">
                  <input class="form-check-input" type="checkbox" id="roleActive" checked>
                  <label class="form-check-label" for="roleActive">Active Role</label>
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-primary" onclick="addRole()">
              <i class="fas fa-plus"></i> Create Role
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- JS Files -->
    <script src="assets/js/core/jquery-3.7.1.min.js"></script>
    <script src="assets/js/core/popper.min.js"></script>
    <script src="assets/js/core/bootstrap.min.js"></script>
    <script src="assets/js/plugin/jquery-scrollbar/jquery.scrollbar.min.js"></script>
    <script src="assets/js/lynxlite.min.js"></script>
    
    <!-- Feedback System -->
    <script src="assets/js/feedback-system.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script>
      // Sample data
      const branchesData = [
        {
          id: 'manhattan',
          name: 'Manhattan Central',
          code: 'MAN-01',
          address: '123 Broadway, New York, NY 10001',
          phone: '+1 (212) 555-0123',
          email: 'manhattan@lynxlite.com',
          manager: 'John Doe',
          capacity: 50,
          currentVehicles: 42,
          staffCount: 12,
          status: 'active',
          performance: 87.5
        },
        {
          id: 'brooklyn',
          name: 'Brooklyn Heights',
          code: 'BRK-01',
          address: '456 Atlantic Ave, Brooklyn, NY 11201',
          phone: '+1 (718) 555-0456',
          email: 'brooklyn@lynxlite.com',
          manager: 'Sarah Johnson',
          capacity: 35,
          currentVehicles: 28,
          staffCount: 8,
          status: 'active',
          performance: 82.3
        },
        {
          id: 'queens',
          name: 'Queens Plaza',
          code: 'QNS-01',
          address: '789 Northern Blvd, Queens, NY 11101',
          phone: '+1 (718) 555-0789',
          email: 'queens@lynxlite.com',
          manager: 'Mike Davis',
          capacity: 40,
          currentVehicles: 31,
          staffCount: 6,
          status: 'active',
          performance: 76.8
        },
        {
          id: 'bronx',
          name: 'Bronx Main',
          code: 'BRX-01',
          address: '321 Grand Concourse, Bronx, NY 10451',
          phone: '+1 (718) 555-0321',
          email: 'bronx@lynxlite.com',
          manager: 'Lisa Wong',
          capacity: 25,
          currentVehicles: 18,
          staffCount: 5,
          status: 'maintenance',
          performance: 68.2
        }
      ];

      const staffData = [
        {
          id: 'john-doe',
          name: 'John Doe',
          email: 'john.doe@lynxlite.com',
          phone: '+1 (555) 123-4567',
          employeeId: 'EMP-001',
          role: 'Manager',
          branch: 'Manhattan',
          status: 'active',
          lastLogin: '2024-12-10 09:15:00',
          avatar: 'assets/img/profile.jpg'
        },
        {
          id: 'sarah-johnson',
          name: 'Sarah Johnson',
          email: 'sarah.j@lynxlite.com',
          phone: '+1 (555) 234-5678',
          employeeId: 'EMP-002',
          role: 'Manager',
          branch: 'Brooklyn',
          status: 'active',
          lastLogin: '2024-12-10 08:45:00',
          avatar: 'assets/img/profile.jpg'
        },
        {
          id: 'mike-davis',
          name: 'Mike Davis',
          email: 'mike.d@lynxlite.com',
          phone: '+1 (555) 345-6789',
          employeeId: 'EMP-003',
          role: 'Dispatcher',
          branch: 'Queens',
          status: 'active',
          lastLogin: '2024-12-10 10:30:00',
          avatar: 'assets/img/profile.jpg'
        },
        {
          id: 'lisa-wong',
          name: 'Lisa Wong',
          email: 'lisa.wong@lynxlite.com',
          phone: '+1 (555) 456-7890',
          employeeId: 'EMP-004',
          role: 'Accountant',
          branch: 'Bronx',
          status: 'active',
          lastLogin: '2024-12-09 16:20:00',
          avatar: 'assets/img/profile.jpg'
        },
        {
          id: 'james-miller',
          name: 'James Miller',
          email: 'james.m@lynxlite.com',
          phone: '+1 (555) 567-8901',
          employeeId: 'EMP-005',
          role: 'Mechanic',
          branch: 'Manhattan',
          status: 'active',
          lastLogin: '2024-12-10 07:00:00',
          avatar: 'assets/img/profile.jpg'
        }
      ];

      const rolesData = [
        {
          id: 'admin',
          name: 'Administrator',
          description: 'Full system access and management capabilities',
          userCount: 2,
          permissions: ['all'],
          color: 'danger'
        },
        {
          id: 'manager',
          name: 'Branch Manager',
          description: 'Branch operations and staff management',
          userCount: 4,
          permissions: ['fleet', 'booking', 'customers', 'billing', 'staff'],
          color: 'primary'
        },
        {
          id: 'dispatcher',
          name: 'Dispatcher',
          description: 'Vehicle assignment and route coordination',
          userCount: 8,
          permissions: ['fleet', 'booking', 'telematics'],
          color: 'success'
        },
        {
          id: 'accountant',
          name: 'Accountant',
          description: 'Financial management and billing operations',
          userCount: 6,
          permissions: ['billing', 'reports'],
          color: 'info'
        },
        {
          id: 'mechanic',
          name: 'Mechanic',
          description: 'Vehicle maintenance and repair coordination',
          userCount: 5,
          permissions: ['maintenance', 'fleet-view'],
          color: 'warning'
        },
        {
          id: 'customer-service',
          name: 'Customer Service',
          description: 'Customer support and booking assistance',
          userCount: 3,
          permissions: ['customers', 'booking', 'basic-reports'],
          color: 'secondary'
        }
      ];

      const systemModules = [
        'Dashboard', 'Fleet Management', 'Booking Management', 'Customer Management',
        'Billing & Payments', 'Maintenance & Compliance', 'Telematics & Tracking',
        'Reports & Analytics', 'Branch/Staff Management', 'System Settings'
      ];

      const permissionTypes = ['View', 'Create', 'Edit', 'Delete', 'Export', 'Admin'];

      // Enhanced Analytics Data
      const staffProductivityData = [
        { name: 'John Doe', bookingsProcessed: 145, customerRating: 4.8, revenueGenerated: 28500, efficiencyScore: 92, workload: 'High', performance: 'Excellent' },
        { name: 'Sarah Johnson', bookingsProcessed: 132, customerRating: 4.6, revenueGenerated: 24200, efficiencyScore: 88, workload: 'Medium', performance: 'Good' },
        { name: 'Mike Davis', bookingsProcessed: 98, customerRating: 4.4, revenueGenerated: 18900, efficiencyScore: 78, workload: 'Medium', performance: 'Good' },
        { name: 'Lisa Wong', bookingsProcessed: 156, customerRating: 4.9, revenueGenerated: 31200, efficiencyScore: 95, workload: 'High', performance: 'Excellent' },
        { name: 'James Miller', bookingsProcessed: 67, customerRating: 4.2, revenueGenerated: 12800, efficiencyScore: 72, workload: 'Low', performance: 'Average' }
      ];

      const trainingModulesData = [
        { module: 'Customer Service Excellence', completionRate: 89, avgScore: 87, requiredFor: 'All Staff', nextSession: '2024-12-15', status: 'active' },
        { module: 'Vehicle Safety & Inspection', completionRate: 76, avgScore: 82, requiredFor: 'Dispatchers, Mechanics', nextSession: '2024-12-18', status: 'active' },
        { module: 'Financial Operations', completionRate: 94, avgScore: 91, requiredFor: 'Managers, Accountants', nextSession: '2024-12-20', status: 'active' },
        { module: 'Emergency Procedures', completionRate: 67, avgScore: 78, requiredFor: 'All Staff', nextSession: '2024-12-22', status: 'mandatory' },
        { module: 'Data Privacy & Security', completionRate: 85, avgScore: 89, requiredFor: 'All Staff', nextSession: '2024-12-25', status: 'active' }
      ];

      const staffDevelopmentData = [
        { name: 'John Doe', currentLevel: 'Senior', trainingProgress: 85, performanceScore: 92, nextReview: '2025-01-15', careerPath: 'Branch Manager → Regional Manager' },
        { name: 'Sarah Johnson', currentLevel: 'Manager', trainingProgress: 78, performanceScore: 88, nextReview: '2025-01-20', careerPath: 'Manager → Senior Manager' },
        { name: 'Mike Davis', currentLevel: 'Dispatcher', trainingProgress: 92, performanceScore: 84, nextReview: '2025-01-25', careerPath: 'Dispatcher → Operations Manager' },
        { name: 'Lisa Wong', currentLevel: 'Senior', trainingProgress: 96, performanceScore: 95, nextReview: '2025-01-10', careerPath: 'Senior Accountant → Finance Manager' }
      ];

      const announcementsData = [
        { title: 'Holiday Schedule Update', content: 'Updated operating hours for holiday season', priority: 'high', date: '2024-12-10', author: 'HR Department' },
        { title: 'New Safety Protocols', content: 'Enhanced vehicle inspection procedures', priority: 'medium', date: '2024-12-09', author: 'Operations' },
        { title: 'Customer Service Training', content: 'Mandatory training session scheduled', priority: 'high', date: '2024-12-08', author: 'Training Dept' }
      ];

      const tasksData = [
        { id: 'TASK-001', title: 'Update vehicle inventory', assignedTo: 'Mike Davis', dueDate: '2024-12-15', priority: 'high', status: 'in-progress' },
        { id: 'TASK-002', title: 'Process monthly reports', assignedTo: 'Lisa Wong', dueDate: '2024-12-12', priority: 'medium', status: 'pending' },
        { id: 'TASK-003', title: 'Customer feedback analysis', assignedTo: 'Sarah Johnson', dueDate: '2024-12-18', priority: 'low', status: 'completed' }
      ];

      const conversationsData = [
        { id: 'conv-1', participants: ['John Doe', 'Sarah Johnson'], lastMessage: 'Schedule updated for next week', time: '10 min ago', unread: 2 },
        { id: 'conv-2', participants: ['Mike Davis', 'Lisa Wong'], lastMessage: 'Vehicle inspection completed', time: '1 hour ago', unread: 0 },
        { id: 'conv-3', participants: ['All Staff'], lastMessage: 'Holiday party planning', time: '3 hours ago', unread: 5 }
      ];

      const auditTrailData = [
        { action: 'Login', user: 'John Doe', ip: '192.168.1.100', timestamp: '2024-12-10 09:15:23', details: 'Successful login from Manhattan branch' },
        { action: 'Permission Change', user: 'Admin', ip: '192.168.1.1', timestamp: '2024-12-10 08:45:12', details: 'Updated permissions for Sarah Johnson' },
        { action: 'Failed Login', user: 'Unknown', ip: '203.45.67.89', timestamp: '2024-12-10 03:22:45', details: 'Multiple failed login attempts' },
        { action: 'Data Export', user: 'Lisa Wong', ip: '192.168.1.105', timestamp: '2024-12-09 16:30:18', details: 'Exported staff productivity report' }
      ];

      const securityAlertsData = [
        { type: 'Failed Login', description: 'Multiple failed login attempts', userIP: '203.45.67.89', timestamp: '2024-12-10 03:22:45', severity: 'high', status: 'investigating' },
        { type: 'Unusual Access', description: 'After-hours system access', userIP: 'Mike Davis / 192.168.1.103', timestamp: '2024-12-09 23:15:30', severity: 'medium', status: 'resolved' },
        { type: 'Permission Escalation', description: 'User requested admin privileges', userIP: 'James Miller / 192.168.1.108', timestamp: '2024-12-09 14:20:15', severity: 'low', status: 'pending' }
      ];

      const leaveRequestsData = [
        { name: 'Mike Davis', type: 'Vacation', dates: 'Dec 20-25', status: 'approved', coverage: 'John Doe' },
        { name: 'James Miller', type: 'Sick Leave', dates: 'Dec 12', status: 'pending', coverage: 'TBD' },
        { name: 'Sarah Johnson', type: 'Personal', dates: 'Dec 18', status: 'approved', coverage: 'Lisa Wong' }
      ];

      const certificationsData = [
        { name: 'Customer Service Certification', holders: 18, total: 28, expiryDate: '2025-06-30' },
        { name: 'Vehicle Safety Inspector', holders: 8, total: 12, expiryDate: '2025-03-15' },
        { name: 'Financial Operations', holders: 6, total: 8, expiryDate: '2025-09-20' }
      ];

      // Initialize page
      document.addEventListener('DOMContentLoaded', function() {
        populateBranchesTable();
        populateStaffTable();
        populateRolesContainer();
        populatePermissionMatrix();
        populateModulesList();
        populatePermissionsList();
        populateBranchPerformance();
        initializeEnhancedFeatures();
      });

      function initializeEnhancedFeatures() {
        populateStaffProductivityTable();
        populateTrainingModulesTable();
        populateStaffDevelopmentTable();
        populateAnnouncementsList();
        populateTasksList();
        populateConversationsList();
        populateAuditTrail();
        populateSecurityAlertsTable();
        populateLeaveRequestsList();
        populateCertificationsList();
        initializeScheduleCalendar();
        initializePerformanceChart();
        initializeTrainingChart();
      }

      function populateBranchesTable() {
        const tbody = document.getElementById('branchesTableBody');
        tbody.innerHTML = '';

        branchesData.forEach(branch => {
          const statusBadge = getStatusBadge(branch.status);
          const capacityPercentage = Math.round((branch.currentVehicles / branch.capacity) * 100);
          
          const row = `
            <tr onclick="viewBranchDetails('${branch.id}')" style="cursor: pointer;">
              <td>
                <div class="fw-bold">${branch.name}</div>
                <small class="text-muted">${branch.code}</small>
              </td>
              <td>
                <div>${branch.address}</div>
              </td>
              <td>
                <div>${branch.phone}</div>
                <small class="text-muted">${branch.email}</small>
              </td>
              <td>
                <div>${branch.currentVehicles}/${branch.capacity} vehicles</div>
                <div class="progress mt-1" style="height: 4px;">
                  <div class="progress-bar ${getCapacityColor(capacityPercentage)}" style="width: ${capacityPercentage}%"></div>
                </div>
              </td>
              <td><span class="badge bg-info">${branch.staffCount}</span></td>
              <td>${statusBadge}</td>
              <td>
                <div class="btn-group btn-group-sm">
                  <button class="btn btn-outline-primary" onclick="event.stopPropagation(); editBranch('${branch.id}')" title="Edit">
                    <i class="fas fa-edit"></i>
                  </button>
                  <button class="btn btn-outline-info" onclick="event.stopPropagation(); viewBranchDetails('${branch.id}')" title="Details">
                    <i class="fas fa-eye"></i>
                  </button>
                  <button class="btn btn-outline-warning" onclick="event.stopPropagation(); manageBranchStaff('${branch.id}')" title="Staff">
                    <i class="fas fa-users"></i>
                  </button>
                </div>
              </td>
            </tr>
          `;
          tbody.innerHTML += row;
        });
      }

      function populateStaffTable() {
        const tbody = document.getElementById('staffTableBody');
        tbody.innerHTML = '';

        staffData.forEach(staff => {
          const statusBadge = getStaffStatusBadge(staff.status);
          const lastLogin = new Date(staff.lastLogin).toLocaleDateString();
          
          const row = `
            <tr onclick="viewStaffDetails('${staff.id}')" style="cursor: pointer;">
              <td>
                <div class="d-flex align-items-center">
                  <img src="${staff.avatar}" alt="Avatar" class="rounded-circle me-2" width="32" height="32">
                  <div>
                    <div class="fw-bold">${staff.name}</div>
                    <small class="text-muted">${staff.employeeId}</small>
                  </div>
                </div>
              </td>
              <td><span class="badge bg-${getRoleColor(staff.role)}">${staff.role}</span></td>
              <td>${staff.branch}</td>
              <td>
                <div>${staff.phone}</div>
                <small class="text-muted">${staff.email}</small>
              </td>
              <td>${statusBadge}</td>
              <td>${lastLogin}</td>
              <td>
                <div class="btn-group btn-group-sm">
                  <button class="btn btn-outline-primary" onclick="event.stopPropagation(); editStaff('${staff.id}')" title="Edit">
                    <i class="fas fa-edit"></i>
                  </button>
                  <button class="btn btn-outline-success" onclick="event.stopPropagation(); resetPassword('${staff.id}')" title="Reset Password">
                    <i class="fas fa-key"></i>
                  </button>
                  <button class="btn btn-outline-warning" onclick="event.stopPropagation(); managePermissions('${staff.id}')" title="Permissions">
                    <i class="fas fa-shield-alt"></i>
                  </button>
                </div>
              </td>
            </tr>
          `;
          tbody.innerHTML += row;
        });
      }

      function populateRolesContainer() {
        const container = document.getElementById('rolesContainer');
        container.innerHTML = '';

        rolesData.forEach(role => {
          const roleCard = `
            <div class="role-card mb-3 p-3 border rounded">
              <div class="d-flex justify-content-between align-items-start">
                <div class="flex-grow-1">
                  <h6 class="mb-1">
                    <span class="badge bg-${role.color} me-2">${role.name}</span>
                    <small class="text-muted">${role.userCount} users</small>
                  </h6>
                  <p class="text-muted mb-2">${role.description}</p>
                  <div class="permissions-tags">
                    ${role.permissions.map(permission => `<span class="badge bg-light text-dark me-1">${permission}</span>`).join('')}
                  </div>
                </div>
                <div class="ms-3">
                  <div class="btn-group btn-group-sm">
                    <button class="btn btn-outline-primary" onclick="editRole('${role.id}')" title="Edit Role">
                      <i class="fas fa-edit"></i>
                    </button>
                    <button class="btn btn-outline-info" onclick="viewRolePermissions('${role.id}')" title="View Permissions">
                      <i class="fas fa-shield-alt"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          `;
          container.innerHTML += roleCard;
        });
      }

      function populatePermissionMatrix() {
        const tbody = document.getElementById('permissionMatrix');
        tbody.innerHTML = '';

        systemModules.forEach(module => {
          const row = `
            <tr>
              <td><strong>${module}</strong></td>
              <td><i class="fas fa-check text-success"></i></td>
              <td><i class="fas fa-check text-success"></i></td>
              <td><i class="fas fa-times text-danger"></i></td>
              <td><i class="fas fa-check text-success"></i></td>
              <td><i class="fas fa-times text-danger"></i></td>
            </tr>
          `;
          tbody.innerHTML += row;
        });
      }

      function populateModulesList() {
        const container = document.getElementById('modulesList');
        container.innerHTML = systemModules.map(module => `
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="module_${module.replace(/\s+/g, '_')}" checked>
            <label class="form-check-label" for="module_${module.replace(/\s+/g, '_')}">${module}</label>
          </div>
        `).join('');
      }

      function populatePermissionsList() {
        const container = document.getElementById('permissionsList');
        container.innerHTML = permissionTypes.map(permission => `
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="permission_${permission.toLowerCase()}">
            <label class="form-check-label" for="permission_${permission.toLowerCase()}">${permission}</label>
          </div>
        `).join('');
      }

      function populateBranchPerformance() {
        const container = document.getElementById('branchPerformanceList');
        container.innerHTML = branchesData.map(branch => {
          const performanceColor = branch.performance >= 80 ? 'success' : branch.performance >= 70 ? 'warning' : 'danger';
          return `
            <div class="d-flex justify-content-between align-items-center mb-3">
              <div>
                <div class="fw-bold">${branch.name}</div>
                <small class="text-muted">${branch.staffCount} staff, ${branch.currentVehicles} vehicles</small>
              </div>
              <div class="text-end">
                <div class="fw-bold text-${performanceColor}">${branch.performance}%</div>
                <div class="progress" style="width: 60px; height: 4px;">
                  <div class="progress-bar bg-${performanceColor}" style="width: ${branch.performance}%"></div>
                </div>
              </div>
            </div>
          `;
        }).join('');
      }

      // Utility functions
      function getStatusBadge(status) {
        const badges = {
          active: 'bg-success',
          inactive: 'bg-secondary',
          maintenance: 'bg-warning'
        };
        return `<span class="badge ${badges[status] || 'bg-secondary'}">${status.charAt(0).toUpperCase() + status.slice(1)}</span>`;
      }

      function getStaffStatusBadge(status) {
        const badges = {
          active: 'bg-success',
          inactive: 'bg-secondary',
          suspended: 'bg-danger'
        };
        return `<span class="badge ${badges[status] || 'bg-secondary'}">${status.charAt(0).toUpperCase() + status.slice(1)}</span>`;
      }

      function getCapacityColor(percentage) {
        if (percentage >= 90) return 'bg-danger';
        if (percentage >= 75) return 'bg-warning';
        return 'bg-success';
      }

      function getRoleColor(role) {
        const colors = {
          'Manager': 'primary',
          'Dispatcher': 'success',
          'Accountant': 'info',
          'Mechanic': 'warning',
          'Admin': 'danger'
        };
        return colors[role] || 'secondary';
      }

      // Action functions
      function addBranch() {
        const name = document.getElementById('branchName').value;
        const code = document.getElementById('branchCode').value;
        
        if (name && code) {
          alert(`Branch "${name}" (${code}) added successfully!`);
          bootstrap.Modal.getInstance(document.getElementById('addBranchModal')).hide();
          populateBranchesTable();
        }
      }

      function addStaff() {
        const name = document.getElementById('staffName').value;
        const email = document.getElementById('staffEmail').value;
        const role = document.getElementById('staffRole').value;
        
        if (name && email && role) {
          alert(`Staff member "${name}" added successfully!`);
          bootstrap.Modal.getInstance(document.getElementById('addStaffModal')).hide();
          populateStaffTable();
        }
      }

      function addRole() {
        const roleName = document.getElementById('roleName').value;
        
        if (roleName) {
          alert(`Role "${roleName}" created successfully!`);
          bootstrap.Modal.getInstance(document.getElementById('addRoleModal')).hide();
          populateRolesContainer();
        }
      }

      function viewBranchDetails(branchId) {
        alert(`Viewing details for branch: ${branchId}`);
      }

      function editBranch(branchId) {
        alert(`Editing branch: ${branchId}`);
      }

      function manageBranchStaff(branchId) {
        alert(`Managing staff for branch: ${branchId}`);
      }

      function viewStaffDetails(staffId) {
        alert(`Viewing staff details: ${staffId}`);
      }

      function editStaff(staffId) {
        alert(`Editing staff: ${staffId}`);
      }

      function resetPassword(staffId) {
        if (confirm('Reset password for this staff member?')) {
          alert(`Password reset link sent to staff member: ${staffId}`);
        }
      }

      function managePermissions(staffId) {
        alert(`Managing permissions for staff: ${staffId}`);
      }

      function editRole(roleId) {
        alert(`Editing role: ${roleId}`);
      }

      function viewRolePermissions(roleId) {
        alert(`Viewing permissions for role: ${roleId}`);
      }

      function saveRBACConfiguration() {
        alert('RBAC configuration saved successfully!');
      }

      function resetRBACConfiguration() {
        if (confirm('Reset RBAC configuration to default?')) {
          alert('RBAC configuration reset!');
        }
      }

      function exportStaffList() {
        alert('Exporting staff list...');
      }

      // Enhanced Features Functions
      function populateStaffProductivityTable() {
        const tbody = document.getElementById('staffProductivityTable');
        tbody.innerHTML = '';

        staffProductivityData.forEach(staff => {
          const efficiencyBadge = getEfficiencyBadge(staff.efficiencyScore);
          const workloadBadge = getWorkloadBadge(staff.workload);
          const performanceBadge = getPerformanceBadge(staff.performance);
          const ratingStars = generateStarRating(staff.customerRating);
          
          const row = `
            <tr>
              <td><strong>${staff.name}</strong></td>
              <td><span class="badge bg-info">${staff.bookingsProcessed}</span></td>
              <td>
                <div class="d-flex align-items-center">
                  ${ratingStars}
                  <span class="ms-2">${staff.customerRating}</span>
                </div>
              </td>
              <td><strong class="text-success">$${staff.revenueGenerated.toLocaleString()}</strong></td>
              <td>${efficiencyBadge}</td>
              <td>${workloadBadge}</td>
              <td>${performanceBadge}</td>
            </tr>
          `;
          tbody.innerHTML += row;
        });
      }

      function populateTrainingModulesTable() {
        const tbody = document.getElementById('trainingModulesTable');
        tbody.innerHTML = '';

        trainingModulesData.forEach(module => {
          const statusBadge = module.status === 'mandatory' ? 
            '<span class="badge bg-danger">Mandatory</span>' : 
            '<span class="badge bg-success">Active</span>';
          
          const row = `
            <tr>
              <td><strong>${module.module}</strong></td>
              <td>
                <div class="d-flex align-items-center">
                  <div class="progress me-2" style="width: 80px; height: 6px;">
                    <div class="progress-bar bg-${getCompletionColor(module.completionRate)}" style="width: ${module.completionRate}%"></div>
                  </div>
                  ${module.completionRate}%
                </div>
              </td>
              <td><span class="badge bg-primary">${module.avgScore}%</span></td>
              <td><small>${module.requiredFor}</small></td>
              <td>${new Date(module.nextSession).toLocaleDateString()}</td>
              <td>
                <div class="btn-group btn-group-sm">
                  <button class="btn btn-outline-primary" onclick="viewTrainingDetails('${module.module}')" title="View Details">
                    <i class="fas fa-eye"></i>
                  </button>
                  <button class="btn btn-outline-success" onclick="scheduleTraining('${module.module}')" title="Schedule">
                    <i class="fas fa-calendar-plus"></i>
                  </button>
                </div>
              </td>
            </tr>
          `;
          tbody.innerHTML += row;
        });
      }

      function populateStaffDevelopmentTable() {
        const tbody = document.getElementById('staffDevelopmentTable');
        tbody.innerHTML = '';

        staffDevelopmentData.forEach(staff => {
          const levelBadge = `<span class="badge bg-primary">${staff.currentLevel}</span>`;
          const performanceBadge = getPerformanceScoreBadge(staff.performanceScore);
          
          const row = `
            <tr>
              <td><strong>${staff.name}</strong></td>
              <td>${levelBadge}</td>
              <td>
                <div class="d-flex align-items-center">
                  <div class="progress me-2" style="width: 80px; height: 6px;">
                    <div class="progress-bar bg-info" style="width: ${staff.trainingProgress}%"></div>
                  </div>
                  ${staff.trainingProgress}%
                </div>
              </td>
              <td>${performanceBadge}</td>
              <td>${new Date(staff.nextReview).toLocaleDateString()}</td>
              <td><small>${staff.careerPath}</small></td>
              <td>
                <div class="btn-group btn-group-sm">
                  <button class="btn btn-outline-primary" onclick="conductReview('${staff.name}')" title="Review">
                    <i class="fas fa-clipboard-check"></i>
                  </button>
                  <button class="btn btn-outline-success" onclick="planCareerPath('${staff.name}')" title="Career Planning">
                    <i class="fas fa-route"></i>
                  </button>
                </div>
              </td>
            </tr>
          `;
          tbody.innerHTML += row;
        });
      }

      function populateAnnouncementsList() {
        const container = document.getElementById('announcementsList');
        container.innerHTML = '';

        announcementsData.forEach(announcement => {
          const priorityBadge = getPriorityBadge(announcement.priority);
          
          const item = `
            <div class="announcement-item border rounded p-3 mb-3">
              <div class="d-flex justify-content-between align-items-start">
                <div class="flex-grow-1">
                  <h6 class="mb-1">${announcement.title}</h6>
                  <p class="text-muted mb-2">${announcement.content}</p>
                  <small class="text-muted">By ${announcement.author} • ${new Date(announcement.date).toLocaleDateString()}</small>
                </div>
                <div class="ms-3">
                  ${priorityBadge}
                </div>
              </div>
            </div>
          `;
          container.innerHTML += item;
        });
      }

      function populateTasksList() {
        const container = document.getElementById('tasksList');
        container.innerHTML = '';

        tasksData.forEach(task => {
          const statusBadge = getTaskStatusBadge(task.status);
          const priorityBadge = getPriorityBadge(task.priority);
          
          const item = `
            <div class="task-item border rounded p-2 mb-2">
              <div class="d-flex justify-content-between align-items-center">
                <div class="flex-grow-1">
                  <div class="fw-bold">${task.title}</div>
                  <small class="text-muted">Assigned to: ${task.assignedTo}</small>
                  <div class="mt-1">
                    ${statusBadge}
                    ${priorityBadge}
                  </div>
                </div>
                <div class="text-end">
                  <small class="text-muted">Due: ${new Date(task.dueDate).toLocaleDateString()}</small>
                </div>
              </div>
            </div>
          `;
          container.innerHTML += item;
        });
      }

      function populateConversationsList() {
        const container = document.getElementById('conversationsList');
        container.innerHTML = '';

        conversationsData.forEach(conversation => {
          const unreadBadge = conversation.unread > 0 ? 
            `<span class="badge bg-danger rounded-pill">${conversation.unread}</span>` : '';
          
          const item = `
            <div class="conversation-item border rounded p-2 mb-2" style="cursor: pointer;" onclick="openConversation('${conversation.id}')">
              <div class="d-flex justify-content-between align-items-center">
                <div class="flex-grow-1">
                  <div class="fw-bold">${conversation.participants.join(', ')}</div>
                  <small class="text-muted">${conversation.lastMessage}</small>
                </div>
                <div class="text-end">
                  <small class="text-muted">${conversation.time}</small>
                  ${unreadBadge}
                </div>
              </div>
            </div>
          `;
          container.innerHTML += item;
        });
      }

      function populateAuditTrail() {
        const container = document.getElementById('auditTrailList');
        container.innerHTML = '';

        auditTrailData.forEach(entry => {
          const actionIcon = getActionIcon(entry.action);
          
          const item = `
            <div class="audit-item border-start border-3 border-${getActionColor(entry.action)} p-2 mb-2">
              <div class="d-flex align-items-center">
                <i class="fas ${actionIcon} me-2"></i>
                <div class="flex-grow-1">
                  <div class="fw-bold">${entry.action}</div>
                  <small class="text-muted">${entry.user} • ${entry.ip}</small>
                  <div class="small text-muted">${entry.details}</div>
                  <small class="text-muted">${entry.timestamp}</small>
                </div>
              </div>
            </div>
          `;
          container.innerHTML += item;
        });
      }

      function populateSecurityAlertsTable() {
        const tbody = document.getElementById('securityAlertsTable');
        tbody.innerHTML = '';

        securityAlertsData.forEach(alert => {
          const severityBadge = getSeverityBadge(alert.severity);
          const statusBadge = getSecurityStatusBadge(alert.status);
          
          const row = `
            <tr>
              <td><strong>${alert.type}</strong></td>
              <td>${alert.description}</td>
              <td><code>${alert.userIP}</code></td>
              <td>${alert.timestamp}</td>
              <td>${severityBadge}</td>
              <td>${statusBadge}</td>
              <td>
                <div class="btn-group btn-group-sm">
                  <button class="btn btn-outline-primary" onclick="investigateAlert('${alert.type}')" title="Investigate">
                    <i class="fas fa-search"></i>
                  </button>
                  <button class="btn btn-outline-success" onclick="resolveAlert('${alert.type}')" title="Resolve">
                    <i class="fas fa-check"></i>
                  </button>
                </div>
              </td>
            </tr>
          `;
          tbody.innerHTML += row;
        });
      }

      function populateLeaveRequestsList() {
        const container = document.getElementById('leaveRequestsList');
        container.innerHTML = '';

        leaveRequestsData.forEach(request => {
          const statusBadge = getLeaveStatusBadge(request.status);
          
          const item = `
            <div class="leave-item border rounded p-2 mb-2">
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <div class="fw-bold">${request.name}</div>
                  <small class="text-muted">${request.type} • ${request.dates}</small>
                  <div class="mt-1">${statusBadge}</div>
                </div>
                <div class="text-end">
                  <small class="text-muted">Coverage: ${request.coverage}</small>
                </div>
              </div>
            </div>
          `;
          container.innerHTML += item;
        });
      }

      function populateCertificationsList() {
        const container = document.getElementById('certificationsList');
        container.innerHTML = '';

        certificationsData.forEach(cert => {
          const completionRate = Math.round((cert.holders / cert.total) * 100);
          const colorClass = completionRate >= 80 ? 'success' : completionRate >= 60 ? 'warning' : 'danger';
          
          const item = `
            <div class="certification-item mb-3">
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <h6 class="mb-1">${cert.name}</h6>
                  <small class="text-muted">Expires: ${new Date(cert.expiryDate).toLocaleDateString()}</small>
                </div>
                <div class="text-end">
                  <div class="fw-bold text-${colorClass}">${cert.holders}/${cert.total}</div>
                  <div class="progress mt-1" style="width: 60px; height: 4px;">
                    <div class="progress-bar bg-${colorClass}" style="width: ${completionRate}%"></div>
                  </div>
                </div>
              </div>
            </div>
          `;
          container.innerHTML += item;
        });
      }

      function initializeScheduleCalendar() {
        const tbody = document.getElementById('scheduleTableBody');
        const timeSlots = ['8:00 AM', '10:00 AM', '12:00 PM', '2:00 PM', '4:00 PM', '6:00 PM'];
        const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
        
        tbody.innerHTML = '';

        timeSlots.forEach(time => {
          let row = `<tr><td><strong>${time}</strong></td>`;
          
          days.forEach(day => {
            const randomStaff = staffData[Math.floor(Math.random() * staffData.length)];
            const hasShift = Math.random() > 0.3;
            
            if (hasShift) {
              row += `<td><span class="badge bg-success">${randomStaff.name.split(' ')[0]}</span></td>`;
            } else {
              row += `<td><span class="text-muted">-</span></td>`;
            }
          });
          
          row += '</tr>';
          tbody.innerHTML += row;
        });
      }

      function initializePerformanceChart() {
        const ctx = document.getElementById('branchPerformanceChart').getContext('2d');
        new Chart(ctx, {
          type: 'line',
          data: {
            labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
            datasets: [{
              label: 'Manhattan',
              data: [85, 87, 89, 87],
              borderColor: '#007bff',
              backgroundColor: 'rgba(0, 123, 255, 0.1)',
              tension: 0.4
            }, {
              label: 'Brooklyn',
              data: [78, 80, 83, 82],
              borderColor: '#28a745',
              backgroundColor: 'rgba(40, 167, 69, 0.1)',
              tension: 0.4
            }, {
              label: 'Queens',
              data: [72, 75, 78, 77],
              borderColor: '#ffc107',
              backgroundColor: 'rgba(255, 193, 7, 0.1)',
              tension: 0.4
            }, {
              label: 'Bronx',
              data: [65, 68, 70, 68],
              borderColor: '#dc3545',
              backgroundColor: 'rgba(220, 53, 69, 0.1)',
              tension: 0.4
            }]
          },
          options: {
            responsive: true,
            plugins: {
              legend: { position: 'top' }
            },
            scales: {
              y: { beginAtZero: true, max: 100 }
            }
          }
        });
      }

      function initializeTrainingChart() {
        const ctx = document.getElementById('trainingCompletionChart').getContext('2d');
        new Chart(ctx, {
          type: 'doughnut',
          data: {
            labels: ['Completed', 'In Progress', 'Not Started'],
            datasets: [{
              data: [68, 22, 10],
              backgroundColor: ['#28a745', '#ffc107', '#dc3545']
            }]
          },
          options: {
            responsive: true,
            plugins: {
              legend: { position: 'bottom' }
            }
          }
        });
      }

      // Enhanced Utility Functions
      function generateStarRating(rating) {
        const fullStars = Math.floor(rating);
        const hasHalfStar = rating % 1 >= 0.5;
        let stars = '';
        
        for (let i = 0; i < fullStars; i++) {
          stars += '<i class="fas fa-star text-warning"></i>';
        }
        if (hasHalfStar) {
          stars += '<i class="fas fa-star-half-alt text-warning"></i>';
        }
        const emptyStars = 5 - Math.ceil(rating);
        for (let i = 0; i < emptyStars; i++) {
          stars += '<i class="far fa-star text-muted"></i>';
        }
        
        return stars;
      }

      function getEfficiencyBadge(score) {
        if (score >= 90) return `<span class="badge bg-success">${score}%</span>`;
        if (score >= 75) return `<span class="badge bg-warning">${score}%</span>`;
        return `<span class="badge bg-danger">${score}%</span>`;
      }

      function getWorkloadBadge(workload) {
        const colors = { 'High': 'danger', 'Medium': 'warning', 'Low': 'success' };
        return `<span class="badge bg-${colors[workload]}">${workload}</span>`;
      }

      function getPerformanceBadge(performance) {
        const colors = { 'Excellent': 'success', 'Good': 'primary', 'Average': 'warning', 'Poor': 'danger' };
        return `<span class="badge bg-${colors[performance]}">${performance}</span>`;
      }

      function getPerformanceScoreBadge(score) {
        if (score >= 90) return `<span class="badge bg-success">${score}%</span>`;
        if (score >= 80) return `<span class="badge bg-primary">${score}%</span>`;
        if (score >= 70) return `<span class="badge bg-warning">${score}%</span>`;
        return `<span class="badge bg-danger">${score}%</span>`;
      }

      function getCompletionColor(rate) {
        if (rate >= 80) return 'success';
        if (rate >= 60) return 'warning';
        return 'danger';
      }

      function getPriorityBadge(priority) {
        const colors = { 'high': 'danger', 'medium': 'warning', 'low': 'info' };
        return `<span class="badge bg-${colors[priority]}">${priority.toUpperCase()}</span>`;
      }

      function getTaskStatusBadge(status) {
        const colors = { 'completed': 'success', 'in-progress': 'primary', 'pending': 'warning' };
        return `<span class="badge bg-${colors[status]}">${status.replace('-', ' ').toUpperCase()}</span>`;
      }

      function getSeverityBadge(severity) {
        const colors = { 'high': 'danger', 'medium': 'warning', 'low': 'info' };
        return `<span class="badge bg-${colors[severity]}">${severity.toUpperCase()}</span>`;
      }

      function getSecurityStatusBadge(status) {
        const colors = { 'investigating': 'warning', 'resolved': 'success', 'pending': 'info' };
        return `<span class="badge bg-${colors[status]}">${status.toUpperCase()}</span>`;
      }

      function getLeaveStatusBadge(status) {
        const colors = { 'approved': 'success', 'pending': 'warning', 'denied': 'danger' };
        return `<span class="badge bg-${colors[status]}">${status.toUpperCase()}</span>`;
      }

      function getActionIcon(action) {
        const icons = {
          'Login': 'fa-sign-in-alt',
          'Permission Change': 'fa-user-shield',
          'Failed Login': 'fa-exclamation-triangle',
          'Data Export': 'fa-download'
        };
        return icons[action] || 'fa-info';
      }

      function getActionColor(action) {
        const colors = {
          'Login': 'success',
          'Permission Change': 'info',
          'Failed Login': 'danger',
          'Data Export': 'primary'
        };
        return colors[action] || 'secondary';
      }

      // Enhanced Action Functions
      function showRealTimeMonitoring() {
        alert('Opening real-time monitoring dashboard...\n\nShowing:\n• Live staff status\n• Branch capacity alerts\n• System performance\n• Security monitoring');
      }

      function optimizeSchedule() {
        alert('Running schedule optimization...\n\nAnalyzing:\n• Staff availability\n• Peak demand periods\n• Workload distribution\n• Coverage requirements');
      }

      function createShift() {
        alert('Opening shift creation form...\n\nConfigure:\n• Time slots\n• Staff assignments\n• Branch coverage\n• Special requirements');
      }

      function manageLeaveRequests() {
        alert('Opening leave management system...\n\nManage:\n• Pending requests\n• Approval workflow\n• Coverage planning\n• Calendar integration');
      }

      function createTrainingModule() {
        alert('Creating new training module...\n\nSetup:\n• Module content\n• Required roles\n• Assessment criteria\n• Scheduling options');
      }

      function createAnnouncement() {
        alert('Creating company announcement...\n\nConfigure:\n• Message content\n• Target audience\n• Priority level\n• Delivery method');
      }

      function createTask() {
        alert('Assigning new task...\n\nSetup:\n• Task details\n• Assignee selection\n• Due date\n• Priority level');
      }

      function openConversation(conversationId) {
        alert(`Opening conversation: ${conversationId}\n\nFeatures:\n• Real-time messaging\n• File sharing\n• Message history\n• Read receipts`);
      }

      function manageIPRestrictions() {
        alert('Managing IP restrictions...\n\nConfigure:\n• Allowed IP ranges\n• Branch-specific access\n• VPN requirements\n• Whitelist management');
      }

      function investigateAlert(alertType) {
        alert(`Investigating security alert: ${alertType}\n\nActions:\n• Review logs\n• Check user activity\n• Analyze patterns\n• Generate report`);
      }

      function resolveAlert(alertType) {
        alert(`Resolving security alert: ${alertType}\n\nResolution logged and alert marked as resolved.`);
      }

      function viewTrainingDetails(module) {
        alert(`Viewing training details for: ${module}\n\nIncludes:\n• Completion statistics\n• Performance scores\n• Feedback summary\n• Next session planning`);
      }

      function scheduleTraining(module) {
        alert(`Scheduling training session for: ${module}\n\nSetup:\n• Session date/time\n• Participant selection\n• Resource allocation\n• Assessment planning`);
      }

      function conductReview(staffName) {
        alert(`Conducting performance review for: ${staffName}\n\nReview areas:\n• Goal achievement\n• Skill development\n• Customer feedback\n• Career planning`);
      }

      function planCareerPath(staffName) {
        alert(`Planning career path for: ${staffName}\n\nIncludes:\n• Skill gap analysis\n• Training recommendations\n• Promotion timeline\n• Goal setting`);
      }


      // Dark mode toggle logic
      const darkModeSwitch = document.getElementById('darkModeSwitch');
      function setDarkMode(enabled) {
        if (enabled) {
          document.body.classList.add('dark-mode');
        } else {
          document.body.classList.remove('dark-mode');
        }
      }
      // On load, check localStorage
      document.addEventListener('DOMContentLoaded', function() {
        const darkPref = localStorage.getItem('darkMode') === 'true';
        setDarkMode(darkPref);
        if (darkModeSwitch) darkModeSwitch.checked = darkPref;
        if (darkModeSwitch) {
          darkModeSwitch.addEventListener('change', function() {
            setDarkMode(this.checked);
            localStorage.setItem('darkMode', this.checked);
          });
        }
      });
    </script>
  </body>
</html>