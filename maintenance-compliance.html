<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Maintenance & Compliance - LynxLite</title>
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport" />
    <!-- Fonts and icons -->
    <script src="assets/js/plugin/webfont/webfont.min.js"></script>
    <script>
      WebFont.load({
        google: { families: ["Public Sans:300,400,500,600,700"] },
        custom: {
          families: [
            "Font Awesome 5 Solid",
            "Font Awesome 5 Regular", 
            "Font Awesome 5 Brands",
            "simple-line-icons",
          ],
          urls: ["assets/css/fonts.min.css"],
        },
        active: function () {
          sessionStorage.fonts = true;
        },
      });
    </script>
    <!-- CSS Files -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="assets/css/plugins.min.css" />
    <link rel="stylesheet" href="assets/css/lynxlite.min.css" />
    <link rel="stylesheet" href="assets/css/demo.css" />
    <link rel="stylesheet" href="assets/css/unified-custom.css" />
  </head>
  <body>
    <div class="wrapper">
      <!-- Sidebar -->
      <div class="sidebar" data-background-color="dark">
        <div class="sidebar-logo">
          <div class="logo-header" data-background-color="dark">
            <a href="index.html" class="logo">
              <img src="assets/img/lynxlite/logo_light.svg" alt="LynxLite - Acacus" class="navbar-brand" height="45" />
            </a>
            <div class="nav-toggle">
              <button class="btn btn-toggle toggle-sidebar"><i class="gg-menu-right"></i></button>
              <button class="btn btn-toggle sidenav-toggler"><i class="gg-menu-left"></i></button>
            </div>
            <button class="topbar-toggler more"><i class="gg-more-vertical-alt"></i></button>
          </div>
        </div>
        <div class="sidebar-wrapper scrollbar scrollbar-inner">
          <div class="sidebar-content">
            <ul class="nav nav-secondary">
              <li class="nav-item">
                <a href="index.html"><i class="fas fa-home"></i><p>Dashboard (Overview)</p></a>
              </li>
              <li class="nav-item">
                <a href="fleet-management.html"><i class="fas fa-car"></i><p>Fleet Management</p></a>
              </li>
              <li class="nav-item">
                <a href="booking-management.html"><i class="fas fa-calendar-alt"></i><p>Booking Management</p></a>
              </li>
              <li class="nav-item">
                <a href="customer-management.html"><i class="fas fa-users"></i><p>Customer Management</p></a>
              </li>
              <li class="nav-item">
                <a href="billing-payments.html"><i class="fas fa-credit-card"></i><p>Billing & Payments</p></a>
              </li>
              <li class="nav-item active">
                <a href="maintenance-compliance.html"><i class="fas fa-wrench"></i><p>Maintenance & Compliance</p></a>
              </li>
              <li class="nav-item">
                <a href="telematics-tracking.html"><i class="fas fa-map-marked-alt"></i><p>Telematics & Tracking</p></a>
              </li>
              <li class="nav-item">
                <a href="reports-analytics.html"><i class="fas fa-chart-line"></i><p>Reports & Analytics</p></a>
              </li>
              <li class="nav-item">
                <a href="branch-staff-management.html"><i class="fas fa-building"></i><p>Branch / Staff Management</p></a>
              </li>
              <li class="nav-item">
                <a href="#"><i class="fas fa-cogs"></i><p>System Settings</p></a>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <!-- End Sidebar -->
      
      <div class="main-panel">
        <div class="main-header">
          <div class="main-header-logo">
            <div class="logo-header" data-background-color="dark">
              <a href="index.html" class="logo">
                <img src="assets/img/lynxlite/logo_light.svg" alt="LynxLite - Acacus" class="navbar-brand" height="20" />
              </a>
              <div class="nav-toggle">
                <button class="btn btn-toggle toggle-sidebar"><i class="gg-menu-right"></i></button>
                <button class="btn btn-toggle sidenav-toggler"><i class="gg-menu-left"></i></button>
              </div>
              <button class="topbar-toggler more"><i class="gg-more-vertical-alt"></i></button>
            </div>
          </div>
          <!-- Navbar Header -->
          <nav class="navbar navbar-header navbar-header-transparent navbar-expand-lg border-bottom">
            <div class="container-fluid">
              <nav class="navbar navbar-header-left navbar-expand-lg navbar-form nav-search p-0 d-none d-lg-flex">
                <div class="input-group">
                  <div class="input-group-prepend">
                    <button type="submit" class="btn btn-search pe-1">
                      <i class="fa fa-search search-icon"></i>
                    </button>
                  </div>
                  <input type="text" placeholder="Search vehicles, services..." class="form-control" id="globalSearch" />
                </div>
              </nav>
              <ul class="navbar-nav topbar-nav ms-md-auto align-items-center">
                <li class="nav-item d-flex align-items-center">
                  <div class="form-check form-switch mb-0 ms-2">
                    <input class="form-check-input" type="checkbox" id="darkModeSwitch" />
                    <label class="form-check-label" for="darkModeSwitch" style="color:inherit;">Dark Mode</label>
                  </div>
                </li>
                <li class="nav-item topbar-icon dropdown hidden-caret d-flex d-lg-none">
                  <a class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false" aria-haspopup="true">
                    <i class="fa fa-search"></i>
                  </a>
                  <ul class="dropdown-menu dropdown-search animated fadeIn">
                    <form class="navbar-left navbar-form nav-search">
                      <div class="input-group">
                        <input type="text" placeholder="Search vehicles, services..." class="form-control" />
                      </div>
                    </form>
                  </ul>
                </li>
                <li class="nav-item topbar-icon dropdown hidden-caret">
                  <a class="nav-link dropdown-toggle" href="#" id="messageDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <i class="fa fa-envelope"></i>
                  </a>
                  <ul class="dropdown-menu messages-notif-box animated fadeIn" aria-labelledby="messageDropdown">
                    <li>
                      <div class="dropdown-title d-flex justify-content-between align-items-center">Messages <a href="#" class="small">Mark all as read</a></div>
                    </li>
                    <li>
                      <div class="message-notif-scroll scrollbar-outer">
                        <div class="notif-center">
                          <a href="#"><div class="notif-img"><i class="fas fa-user-circle fa-2x"></i></div><div class="notif-content"><span class="subject">Service Reminder</span><span class="block">BMW X3 (GHI345) - Oil change due</span><span class="time">2 minutes ago</span></div></a>
                        </div>
                      </div>
                    </li>
                    <li><a class="see-all" href="javascript:void(0);">See all messages<i class="fa fa-angle-right"></i></a></li>
                  </ul>
                </li>
                <li class="nav-item topbar-icon dropdown hidden-caret">
                  <a class="nav-link dropdown-toggle" href="#" id="notifDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <i class="fa fa-bell"></i><span class="notification">5</span>
                  </a>
                  <ul class="dropdown-menu notif-box animated fadeIn" aria-labelledby="notifDropdown">
                    <li><div class="dropdown-title">You have 5 new notifications</div></li>
                    <li>
                      <div class="notif-scroll scrollbar-outer">
                        <div class="notif-center">
                          <a href="#" class="notif-item"><div class="notif-icon notif-danger"><i class="fas fa-exclamation-triangle"></i></div><div class="notif-content"><span class="block">Insurance expiring soon</span><span class="time">1 minute ago</span></div></a>
                          <a href="#" class="notif-item"><div class="notif-icon notif-warning"><i class="fas fa-wrench"></i></div><div class="notif-content"><span class="block">Service overdue - Toyota Camry</span><span class="time">30 minutes ago</span></div></a>
                          <a href="#" class="notif-item"><div class="notif-icon notif-info"><i class="fas fa-clipboard-check"></i></div><div class="notif-content"><span class="block">Inspection completed</span><span class="time">2 hours ago</span></div></a>
                        </div>
                      </div>
                    </li>
                    <li><a class="see-all" href="javascript:void(0);">See all notifications<i class="fa fa-angle-right"></i></a></li>
                  </ul>
                </li>
                <li class="nav-item topbar-icon dropdown hidden-caret">
                  <a class="nav-link" data-bs-toggle="dropdown" href="#" aria-expanded="false"><i class="fas fa-layer-group"></i></a>
                  <div class="dropdown-menu quick-actions animated fadeIn">
                    <div class="quick-actions-header"><span class="title mb-1">Quick Actions</span><span class="subtitle op-7">Shortcuts</span></div>
                    <div class="quick-actions-scroll scrollbar-outer">
                      <div class="quick-actions-items">
                        <div class="row m-0">
                          <a class="col-6 col-md-4 p-0" href="fleet-management.html"><div class="quick-actions-item"><div class="avatar-item bg-primary rounded-circle"><i class="fas fa-car"></i></div><span class="text">Fleet</span></div></a>
                          <a class="col-6 col-md-4 p-0" href="booking-management.html"><div class="quick-actions-item"><div class="avatar-item bg-danger rounded-circle"><i class="far fa-calendar-alt"></i></div><span class="text">Bookings</span></div></a>
                          <a class="col-6 col-md-4 p-0" href="customer-management.html"><div class="quick-actions-item"><div class="avatar-item bg-success rounded-circle"><i class="fas fa-users"></i></div><span class="text">Customers</span></div></a>
                          <a class="col-6 col-md-4 p-0" href="billing-payments.html"><div class="quick-actions-item"><div class="avatar-item bg-warning rounded-circle"><i class="fas fa-credit-card"></i></div><span class="text">Payments</span></div></a>
                          <a class="col-6 col-md-4 p-0" href="telematics-tracking.html"><div class="quick-actions-item"><div class="avatar-item bg-info rounded-circle"><i class="fas fa-map"></i></div><span class="text">Tracking</span></div></a>
                          <a class="col-6 col-md-4 p-0" href="reports-analytics.html"><div class="quick-actions-item"><div class="avatar-item bg-secondary rounded-circle"><i class="fas fa-file-excel"></i></div><span class="text">Reports</span></div></a>
                        </div>
                      </div>
                    </div>
                  </div>
                </li>
                <li class="nav-item topbar-user dropdown hidden-caret">
                  <a class="dropdown-toggle profile-pic" data-bs-toggle="dropdown" href="#" aria-expanded="false">
                    <div class="avatar-sm"><i class="fas fa-user-circle fa-2x"></i></div>
                    <span class="profile-username"><span class="op-7">Hi,</span> <span class="fw-bold">Admin</span></span>
                  </a>
                  <ul class="dropdown-menu dropdown-user animated fadeIn">
                    <div class="dropdown-user-scroll scrollbar-outer">
                      <li>
                        <div class="user-box">
                          <div class="avatar-lg"><i class="fas fa-user-circle fa-3x"></i></div>
                          <div class="u-text">
                            <h4>Admin</h4>
                            <p class="text-muted">hello@example.com</p>
                            <a href="profile.html" class="btn btn-xs btn-secondary btn-sm">View Profile</a>
                          </div>
                        </div>
                      </li>
                      <li>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="#">My Profile</a>
                        <a class="dropdown-item" href="#">My Balance</a>
                        <a class="dropdown-item" href="#">Inbox</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="#">Account Setting</a>
                        <a class="dropdown-item" href="#">Logout</a>
                      </li>
                    </div>
                  </ul>
                </li>
              </ul>
            </div>
          </nav>
          
        </div>
        
        <!-- Maintenance & Compliance Content -->
        <div class="container">
          <div class="page-inner">
            <!-- Quick Stats Cards -->
            <div class="row">
              <div class="col-sm-6 col-md-3">
                <div class="card card-stats card-round">
                  <div class="card-body">
                    <div class="row align-items-center">
                      <div class="col-icon">
                        <div class="icon-big text-center icon-warning bubble-shadow-small">
                          <i class="fas fa-wrench"></i>
                        </div>
                      </div>
                      <div class="col col-stats ms-3">
                        <div class="numbers">
                          <p class="card-category">Services Due</p>
                          <h4 class="card-title">12</h4>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-6 col-md-3">
                <div class="card card-stats card-round">
                  <div class="card-body">
                    <div class="row align-items-center">
                      <div class="col-icon">
                        <div class="icon-big text-center icon-danger bubble-shadow-small">
                          <i class="fas fa-shield-alt"></i>
                        </div>
                      </div>
                      <div class="col col-stats ms-3">
                        <div class="numbers">
                          <p class="card-category">Insurance Expiring</p>
                          <h4 class="card-title">3</h4>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-6 col-md-3">
                <div class="card card-stats card-round">
                  <div class="card-body">
                    <div class="row align-items-center">
                      <div class="col-icon">
                        <div class="icon-big text-center icon-info bubble-shadow-small">
                          <i class="fas fa-clipboard-check"></i>
                        </div>
                      </div>
                      <div class="col col-stats ms-3">
                        <div class="numbers">
                          <p class="card-category">Inspections Today</p>
                          <h4 class="card-title">8</h4>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-6 col-md-3">
                <div class="card card-stats card-round">
                  <div class="card-body">
                    <div class="row align-items-center">
                      <div class="col-icon">
                        <div class="icon-big text-center icon-success bubble-shadow-small">
                          <i class="fas fa-check-circle"></i>
                        </div>
                      </div>
                      <div class="col col-stats ms-3">
                        <div class="numbers">
                          <p class="card-category">Compliance Rate</p>
                          <h4 class="card-title">96%</h4>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Navigation Tabs -->
            <div class="row">
              <div class="col-md-12">
                <div class="card">
                  <div class="card-body">
                    <ul class="nav nav-pills nav-pills-success" id="maintenanceTabs" role="tablist">
                      <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="service-tab" data-bs-toggle="pill" data-bs-target="#service" role="tab">
                          <i class="fas fa-wrench me-2"></i>Service Scheduling
                        </button>
                      </li>
                      <li class="nav-item" role="presentation">
                        <button class="nav-link" id="insurance-tab" data-bs-toggle="pill" data-bs-target="#insurance" role="tab">
                          <i class="fas fa-shield-alt me-2"></i>Insurance & Registration
                        </button>
                      </li>
                      <li class="nav-item" role="presentation">
                        <button class="nav-link" id="inspections-tab" data-bs-toggle="pill" data-bs-target="#inspections" role="tab">
                          <i class="fas fa-clipboard-check me-2"></i>Vehicle Inspections
                        </button>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>

            <!-- Tab Content -->
            <div class="tab-content">
              <!-- Service Scheduling Tab -->
              <div class="tab-pane fade show active" id="service" role="tabpanel">
                <div class="row">
                  <div class="col-md-8">
                    <div class="card">
                      <div class="card-header">
                        <div class="d-flex align-items-center justify-content-between">
                          <h4 class="card-title"><i class="fas fa-wrench me-2"></i>Service Schedule</h4>
                          <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#scheduleServiceModal">
                            <i class="fas fa-plus"></i> Schedule Service
                          </button>
                        </div>
                      </div>
                      <div class="card-body">
                        <!-- Service Filters -->
                        <div class="row mb-3">
                          <div class="col-md-3">
                            <select class="form-select" id="serviceStatusFilter">
                              <option value="">All Status</option>
                              <option value="due">Due Now</option>
                              <option value="upcoming">Upcoming</option>
                              <option value="overdue">Overdue</option>
                              <option value="completed">Completed</option>
                            </select>
                          </div>
                          <div class="col-md-3">
                            <select class="form-select" id="serviceTypeFilter">
                              <option value="">All Types</option>
                              <option value="oil-change">Oil Change</option>
                              <option value="brake-service">Brake Service</option>
                              <option value="tire-rotation">Tire Rotation</option>
                              <option value="inspection">Inspection</option>
                              <option value="major-service">Major Service</option>
                            </select>
                          </div>
                          <div class="col-md-3">
                            <input type="text" class="form-control" placeholder="Search vehicle..." id="serviceVehicleFilter">
                          </div>
                          <div class="col-md-3">
                            <button class="btn btn-primary w-100" onclick="applyServiceFilters()">
                              <i class="fas fa-search"></i> Filter
                            </button>
                          </div>
                        </div>

                        <!-- Service Schedule Table -->
                        <div class="table-responsive">
                          <table class="table table-hover">
                            <thead>
                              <tr>
                                <th>Vehicle</th>
                                <th>Service Type</th>
                                <th>Due Date</th>
                                <th>Mileage</th>
                                <th>Status</th>
                                <th>Actions</th>
                              </tr>
                            </thead>
                            <tbody id="serviceScheduleBody">
                              <!-- Populated by JavaScript -->
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <div class="col-md-4">
                    <!-- Service Calendar -->
                    <div class="card">
                      <div class="card-header">
                        <h5 class="card-title mb-0"><i class="fas fa-calendar me-2"></i>Service Calendar</h5>
                      </div>
                      <div class="card-body">
                        <div id="serviceCalendar" style="min-height: 300px;">
                          <!-- Mini calendar would be implemented here -->
                          <div class="text-center text-muted">
                            <i class="fas fa-calendar-alt fa-3x mb-2"></i>
                            <p>Service calendar integration</p>
                          </div>
                        </div>
                      </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="card mt-3">
                      <div class="card-header">
                        <h5 class="card-title mb-0"><i class="fas fa-bolt me-2"></i>Quick Actions</h5>
                      </div>
                      <div class="card-body">
                        <div class="d-grid gap-2">
                          <button class="btn btn-warning btn-sm" onclick="bulkServiceReminder()">
                            <i class="fas fa-bell"></i> Send Service Reminders
                          </button>
                          <button class="btn btn-info btn-sm" onclick="generateServiceReport()">
                            <i class="fas fa-file-alt"></i> Generate Report
                          </button>
                          <button class="btn btn-primary btn-sm" onclick="scheduleMultipleServices()">
                            <i class="fas fa-layer-group"></i> Bulk Schedule
                          </button>
                          <button class="btn btn-secondary btn-sm" onclick="serviceSettings()">
                            <i class="fas fa-cogs"></i> Service Settings
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Insurance & Registration Tab -->
              <div class="tab-pane fade" id="insurance" role="tabpanel">
                <div class="row">
                  <div class="col-md-12">
                    <div class="card">
                      <div class="card-header">
                        <div class="d-flex align-items-center justify-content-between">
                          <h4 class="card-title"><i class="fas fa-shield-alt me-2"></i>Insurance & Registration Tracking</h4>
                          <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#addInsuranceModal">
                            <i class="fas fa-plus"></i> Add Policy
                          </button>
                        </div>
                      </div>
                      <div class="card-body">
                        <div class="table-responsive">
                          <table class="table table-hover">
                            <thead>
                              <tr>
                                <th>Vehicle</th>
                                <th>Insurance Policy</th>
                                <th>Registration</th>
                                <th>Expiry Date</th>
                                <th>Status</th>
                                <th>Days Until Expiry</th>
                                <th>Actions</th>
                              </tr>
                            </thead>
                            <tbody id="insuranceTableBody">
                              <!-- Populated by JavaScript -->
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Vehicle Inspections Tab -->
              <div class="tab-pane fade" id="inspections" role="tabpanel">
                <div class="row">
                  <div class="col-md-8">
                    <div class="card">
                      <div class="card-header">
                        <div class="d-flex align-items-center justify-content-between">
                          <h4 class="card-title"><i class="fas fa-clipboard-check me-2"></i>Vehicle Inspections</h4>
                          <div>
                            <button class="btn btn-outline-primary btn-sm me-2" data-bs-toggle="modal" data-bs-target="#preInspectionModal">
                              <i class="fas fa-clipboard-list"></i> Pre-Check
                            </button>
                            <button class="btn btn-outline-success btn-sm" data-bs-toggle="modal" data-bs-target="#postInspectionModal">
                              <i class="fas fa-clipboard-check"></i> Post-Check
                            </button>
                          </div>
                        </div>
                      </div>
                      <div class="card-body">
                        <!-- Inspection Filters -->
                        <div class="row mb-3">
                          <div class="col-md-3">
                            <select class="form-select" id="inspectionTypeFilter">
                              <option value="">All Types</option>
                              <option value="pre-rental">Pre-Rental</option>
                              <option value="post-return">Post-Return</option>
                              <option value="maintenance">Maintenance</option>
                              <option value="damage-assessment">Damage Assessment</option>
                            </select>
                          </div>
                          <div class="col-md-3">
                            <input type="date" class="form-control" id="inspectionDateFilter">
                          </div>
                          <div class="col-md-3">
                            <input type="text" class="form-control" placeholder="Vehicle or inspector..." id="inspectionSearchFilter">
                          </div>
                          <div class="col-md-3">
                            <button class="btn btn-primary w-100" onclick="applyInspectionFilters()">
                              <i class="fas fa-search"></i> Filter
                            </button>
                          </div>
                        </div>

                        <!-- Inspections Table -->
                        <div class="table-responsive">
                          <table class="table table-hover">
                            <thead>
                              <tr>
                                <th>Vehicle</th>
                                <th>Type</th>
                                <th>Inspector</th>
                                <th>Date</th>
                                <th>Status</th>
                                <th>Issues Found</th>
                                <th>Actions</th>
                              </tr>
                            </thead>
                            <tbody id="inspectionsTableBody">
                              <!-- Populated by JavaScript -->
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <div class="col-md-4">
                    <!-- Recent Inspections -->
                    <div class="card">
                      <div class="card-header">
                        <h5 class="card-title mb-0"><i class="fas fa-history me-2"></i>Recent Inspections</h5>
                      </div>
                      <div class="card-body">
                        <div class="maintenance-timeline" id="inspectionTimeline">
                          <!-- Populated by JavaScript -->
                        </div>
                      </div>
                    </div>

                    <!-- Inspection Stats -->
                    <div class="card mt-3">
                      <div class="card-header">
                        <h5 class="card-title mb-0"><i class="fas fa-chart-pie me-2"></i>Inspection Stats</h5>
                      </div>
                      <div class="card-body">
                        <div class="mb-3">
                          <div class="d-flex justify-content-between">
                            <span>Clean Inspections</span>
                            <strong class="text-success">87%</strong>
                          </div>
                          <div class="progress mt-1" style="height: 6px;">
                            <div class="progress-bar bg-success" style="width: 87%"></div>
                          </div>
                        </div>
                        <div class="mb-3">
                          <div class="d-flex justify-content-between">
                            <span>Minor Issues</span>
                            <strong class="text-warning">10%</strong>
                          </div>
                          <div class="progress mt-1" style="height: 6px;">
                            <div class="progress-bar bg-warning" style="width: 10%"></div>
                          </div>
                        </div>
                        <div class="mb-3">
                          <div class="d-flex justify-content-between">
                            <span>Major Issues</span>
                            <strong class="text-danger">3%</strong>
                          </div>
                          <div class="progress mt-1" style="height: 6px;">
                            <div class="progress-bar bg-danger" style="width: 3%"></div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Schedule Service Modal -->
    <div class="modal fade" id="scheduleServiceModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Schedule Service</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <form id="scheduleServiceForm">
              <div class="row">
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label">Vehicle *</label>
                    <select class="form-select" id="serviceVehicle" required>
                      <option value="">Select Vehicle</option>
                      <option value="ABC123">Toyota Camry - ABC123</option>
                      <option value="XYZ789">Honda CR-V - XYZ789</option>
                      <option value="DEF456">Ford Focus - DEF456</option>
                      <option value="GHI345">BMW X3 - GHI345</option>
                    </select>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Service Type *</label>
                    <select class="form-select" id="serviceType" required>
                      <option value="">Select Service</option>
                      <option value="oil-change">Oil Change</option>
                      <option value="brake-service">Brake Service</option>
                      <option value="tire-rotation">Tire Rotation</option>
                      <option value="inspection">Safety Inspection</option>
                      <option value="major-service">Major Service</option>
                      <option value="transmission">Transmission Service</option>
                      <option value="ac-service">A/C Service</option>
                    </select>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Scheduling Basis *</label>
                    <select class="form-select" id="schedulingBasis" onchange="toggleSchedulingFields()">
                      <option value="date">Date-based</option>
                      <option value="mileage">Mileage-based</option>
                      <option value="both">Both</option>
                    </select>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3" id="dueDateField">
                    <label class="form-label">Due Date</label>
                    <input type="date" class="form-control" id="serviceDueDate">
                  </div>
                  <div class="mb-3" id="mileageField" style="display: none;">
                    <label class="form-label">Due Mileage</label>
                    <input type="number" class="form-control" id="serviceDueMileage" placeholder="e.g. 50000">
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Priority</label>
                    <select class="form-select" id="servicePriority">
                      <option value="low">Low</option>
                      <option value="medium" selected>Medium</option>
                      <option value="high">High</option>
                      <option value="urgent">Urgent</option>
                    </select>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Estimated Cost</label>
                    <input type="number" class="form-control" id="serviceEstimatedCost" placeholder="0.00" step="0.01">
                  </div>
                </div>
              </div>
              <div class="mb-3">
                <label class="form-label">Service Notes</label>
                <textarea class="form-control" id="serviceNotes" rows="3" placeholder="Additional service instructions or notes..."></textarea>
              </div>
              <div class="mb-3">
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" id="enableReminder" checked>
                  <label class="form-check-label" for="enableReminder">
                    Enable automatic reminders
                  </label>
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-success" onclick="scheduleService()">
              <i class="fas fa-wrench"></i> Schedule Service
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Add Insurance Modal -->
    <div class="modal fade" id="addInsuranceModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Add Insurance/Registration</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <form id="addInsuranceForm">
              <div class="row">
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label">Vehicle *</label>
                    <select class="form-select" id="insuranceVehicle" required>
                      <option value="">Select Vehicle</option>
                      <option value="ABC123">Toyota Camry - ABC123</option>
                      <option value="XYZ789">Honda CR-V - XYZ789</option>
                      <option value="DEF456">Ford Focus - DEF456</option>
                      <option value="GHI345">BMW X3 - GHI345</option>
                    </select>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Policy Number *</label>
                    <input type="text" class="form-control" id="policyNumber" placeholder="INS-123456" required>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Insurance Provider *</label>
                    <input type="text" class="form-control" id="insuranceProvider" placeholder="e.g. State Farm" required>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Policy Start Date</label>
                    <input type="date" class="form-control" id="policyStartDate">
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label">Policy Expiry Date *</label>
                    <input type="date" class="form-control" id="policyExpiryDate" required>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Registration Number</label>
                    <input type="text" class="form-control" id="registrationNumber" placeholder="REG-789012">
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Registration Expiry</label>
                    <input type="date" class="form-control" id="registrationExpiry">
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Coverage Amount</label>
                    <input type="number" class="form-control" id="coverageAmount" placeholder="0.00" step="0.01">
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label">Policy Document</label>
                    <input type="file" class="form-control" id="policyDocument" accept=".pdf,.jpg,.jpeg,.png">
                    <div class="form-text">Upload policy document (PDF, JPG, PNG)</div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label">Registration Document</label>
                    <input type="file" class="form-control" id="registrationDocument" accept=".pdf,.jpg,.jpeg,.png">
                    <div class="form-text">Upload registration document</div>
                  </div>
                </div>
              </div>
              <div class="mb-3">
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" id="enableExpiryAlerts" checked>
                  <label class="form-check-label" for="enableExpiryAlerts">
                    Enable expiry alerts (30 days before expiration)
                  </label>
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-success" onclick="addInsuranceRecord()">
              <i class="fas fa-shield-alt"></i> Add Record
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Pre-Inspection Modal -->
    <div class="modal fade" id="preInspectionModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-xl">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Pre-Rental Inspection</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <form id="preInspectionForm">
              <div class="row">
                <div class="col-md-4">
                  <div class="mb-3">
                    <label class="form-label">Vehicle *</label>
                    <select class="form-select" id="preInspectionVehicle" required>
                      <option value="">Select Vehicle</option>
                      <option value="ABC123">Toyota Camry - ABC123</option>
                      <option value="XYZ789">Honda CR-V - XYZ789</option>
                      <option value="DEF456">Ford Focus - DEF456</option>
                      <option value="GHI345">BMW X3 - GHI345</option>
                    </select>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Inspector</label>
                    <input type="text" class="form-control" id="preInspector" placeholder="Inspector name">
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Current Mileage</label>
                    <input type="number" class="form-control" id="preInspectionMileage" placeholder="Current odometer reading">
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Fuel Level</label>
                    <select class="form-select" id="preFuelLevel">
                      <option value="full">Full</option>
                      <option value="3/4">3/4</option>
                      <option value="1/2">1/2</option>
                      <option value="1/4">1/4</option>
                      <option value="empty">Empty</option>
                    </select>
                  </div>
                </div>
                
                <div class="col-md-8">
                  <h6>Vehicle Condition Checklist</h6>
                  <div class="row">
                    <div class="col-md-6">
                      <div class="inspection-section">
                        <h6 class="text-primary">Exterior</h6>
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="bodyCondition" checked>
                          <label class="form-check-label" for="bodyCondition">Body condition (no dents/scratches)</label>
                        </div>
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="lightsWorking" checked>
                          <label class="form-check-label" for="lightsWorking">All lights working</label>
                        </div>
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="tiresCondition" checked>
                          <label class="form-check-label" for="tiresCondition">Tires in good condition</label>
                        </div>
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="mirrorsClean" checked>
                          <label class="form-check-label" for="mirrorsClean">Mirrors clean and intact</label>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="inspection-section">
                        <h6 class="text-primary">Interior</h6>
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="seatsClean" checked>
                          <label class="form-check-label" for="seatsClean">Seats clean and undamaged</label>
                        </div>
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="controlsWorking" checked>
                          <label class="form-check-label" for="controlsWorking">All controls working</label>
                        </div>
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="acWorking" checked>
                          <label class="form-check-label" for="acWorking">A/C and heating working</label>
                        </div>
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="radioWorking" checked>
                          <label class="form-check-label" for="radioWorking">Radio/infotainment working</label>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <div class="mt-3">
                    <label class="form-label">Additional Notes</label>
                    <textarea class="form-control" id="preInspectionNotes" rows="3" placeholder="Any additional observations..."></textarea>
                  </div>
                  
                  <div class="mt-3">
                    <label class="form-label">Upload Photos</label>
                    <input type="file" class="form-control" id="preInspectionPhotos" multiple accept=".jpg,.jpeg,.png">
                    <div class="form-text">Upload photos of vehicle condition (recommended: front, rear, sides, interior, dashboard)</div>
                  </div>
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-primary" onclick="completePreInspection()">
              <i class="fas fa-clipboard-list"></i> Complete Pre-Inspection
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Post-Inspection Modal -->
    <div class="modal fade" id="postInspectionModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-xl">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Post-Return Inspection</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <form id="postInspectionForm">
              <div class="row">
                <div class="col-md-4">
                  <div class="mb-3">
                    <label class="form-label">Vehicle *</label>
                    <select class="form-select" id="postInspectionVehicle" required>
                      <option value="">Select Vehicle</option>
                      <option value="ABC123">Toyota Camry - ABC123</option>
                      <option value="XYZ789">Honda CR-V - XYZ789</option>
                      <option value="DEF456">Ford Focus - DEF456</option>
                      <option value="GHI345">BMW X3 - GHI345</option>
                    </select>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Booking Reference</label>
                    <input type="text" class="form-control" id="postBookingRef" placeholder="BK001">
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Inspector</label>
                    <input type="text" class="form-control" id="postInspector" placeholder="Inspector name">
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Return Mileage</label>
                    <input type="number" class="form-control" id="postInspectionMileage" placeholder="Odometer reading on return">
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Fuel Level on Return</label>
                    <select class="form-select" id="postFuelLevel">
                      <option value="full">Full</option>
                      <option value="3/4">3/4</option>
                      <option value="1/2">1/2</option>
                      <option value="1/4">1/4</option>
                      <option value="empty">Empty</option>
                    </select>
                  </div>
                </div>
                
                <div class="col-md-8">
                  <h6>Damage Assessment</h6>
                  <div class="row">
                    <div class="col-md-6">
                      <div class="inspection-section">
                        <h6 class="text-warning">Exterior Condition</h6>
                        <div class="form-check">
                          <input class="form-check-input" type="radio" name="exteriorCondition" id="exteriorGood" value="good" checked>
                          <label class="form-check-label text-success" for="exteriorGood">Good - No new damage</label>
                        </div>
                        <div class="form-check">
                          <input class="form-check-input" type="radio" name="exteriorCondition" id="exteriorMinor" value="minor">
                          <label class="form-check-label text-warning" for="exteriorMinor">Minor - Small scratches/dents</label>
                        </div>
                        <div class="form-check">
                          <input class="form-check-input" type="radio" name="exteriorCondition" id="exteriorMajor" value="major">
                          <label class="form-check-label text-danger" for="exteriorMajor">Major - Significant damage</label>
                        </div>
                      </div>
                      
                      <div class="inspection-section mt-3">
                        <h6 class="text-warning">Interior Condition</h6>
                        <div class="form-check">
                          <input class="form-check-input" type="radio" name="interiorCondition" id="interiorGood" value="good" checked>
                          <label class="form-check-label text-success" for="interiorGood">Good - Clean and undamaged</label>
                        </div>
                        <div class="form-check">
                          <input class="form-check-input" type="radio" name="interiorCondition" id="interiorMinor" value="minor">
                          <label class="form-check-label text-warning" for="interiorMinor">Minor - Needs cleaning</label>
                        </div>
                        <div class="form-check">
                          <input class="form-check-input" type="radio" name="interiorCondition" id="interiorMajor" value="major">
                          <label class="form-check-label text-danger" for="interiorMajor">Major - Damage/stains</label>
                        </div>
                      </div>
                    </div>
                    
                    <div class="col-md-6">
                      <div class="inspection-section">
                        <h6 class="text-info">Additional Charges</h6>
                        <div class="mb-2">
                          <label class="form-label">Cleaning Fee</label>
                          <input type="number" class="form-control form-control-sm" id="cleaningFee" placeholder="0.00" step="0.01">
                        </div>
                        <div class="mb-2">
                          <label class="form-label">Fuel Charge</label>
                          <input type="number" class="form-control form-control-sm" id="fuelCharge" placeholder="0.00" step="0.01">
                        </div>
                        <div class="mb-2">
                          <label class="form-label">Damage Fee</label>
                          <input type="number" class="form-control form-control-sm" id="damageFee" placeholder="0.00" step="0.01">
                        </div>
                        <div class="mb-2">
                          <label class="form-label">Late Return Fee</label>
                          <input type="number" class="form-control form-control-sm" id="lateReturnFee" placeholder="0.00" step="0.01">
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <div class="mt-3">
                    <label class="form-label">Damage Details & Notes</label>
                    <textarea class="form-control" id="damageDetails" rows="3" placeholder="Describe any damage found, cleaning required, or other issues..."></textarea>
                  </div>
                  
                  <div class="mt-3">
                    <label class="form-label">Upload Damage Photos</label>
                    <input type="file" class="form-control" id="damagePhotos" multiple accept=".jpg,.jpeg,.png">
                    <div class="form-text">Upload photos of any damage or issues found</div>
                  </div>
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-warning" onclick="generateDamageReport()" style="display: none;" id="damageReportBtn">
              <i class="fas fa-file-alt"></i> Generate Damage Report
            </button>
            <button type="button" class="btn btn-success" onclick="completePostInspection()">
              <i class="fas fa-clipboard-check"></i> Complete Post-Inspection
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- JS Files -->
    <script src="assets/js/core/jquery-3.7.1.min.js"></script>
    <script src="assets/js/core/popper.min.js"></script>
    <script src="assets/js/core/bootstrap.min.js"></script>
    <script src="assets/js/plugin/jquery-scrollbar/jquery.scrollbar.min.js"></script>
    <script src="assets/js/lynxlite.min.js"></script>
    
    <!-- Feedback System -->
    <script src="assets/js/feedback-system.js"></script>

    <script>
      // Dark mode toggle logic
      const darkModeSwitch = document.getElementById('darkModeSwitch');
      function setDarkMode(enabled) {
        if (enabled) {
          document.body.classList.add('dark-mode');
        } else {
          document.body.classList.remove('dark-mode');
        }
      }
      // On load, check localStorage
      document.addEventListener('DOMContentLoaded', function() {
        const darkPref = localStorage.getItem('darkMode') === 'true';
        setDarkMode(darkPref);
        if (darkModeSwitch) darkModeSwitch.checked = darkPref;
        if (darkModeSwitch) {
          darkModeSwitch.addEventListener('change', function() {
            setDarkMode(this.checked);
            localStorage.setItem('darkMode', this.checked);
          });
        }
      });
    </script>
    
    <script>
      // Sample service data
      const serviceData = [
        {
          vehicleId: 'ABC123',
          vehicle: 'Toyota Camry - ABC123',
          serviceType: 'Oil Change',
          dueDate: '2024-12-15',
          dueMileage: 45000,
          currentMileage: 44200,
          status: 'due',
          priority: 'medium',
          estimatedCost: 89.99
        },
        {
          vehicleId: 'XYZ789',
          vehicle: 'Honda CR-V - XYZ789',
          serviceType: 'Brake Service',
          dueDate: '2024-12-12',
          dueMileage: 50000,
          currentMileage: 51200,
          status: 'overdue',
          priority: 'high',
          estimatedCost: 299.99
        },
        {
          vehicleId: 'DEF456',
          vehicle: 'Ford Focus - DEF456',
          serviceType: 'Tire Rotation',
          dueDate: '2024-12-20',
          dueMileage: 30000,
          currentMileage: 28500,
          status: 'upcoming',
          priority: 'low',
          estimatedCost: 49.99
        },
        {
          vehicleId: 'GHI345',
          vehicle: 'BMW X3 - GHI345',
          serviceType: 'Major Service',
          dueDate: '2024-12-08',
          dueMileage: 60000,
          currentMileage: 59800,
          status: 'overdue',
          priority: 'urgent',
          estimatedCost: 599.99
        }
      ];

      // Sample insurance data
      const insuranceData = [
        {
          vehicleId: 'ABC123',
          vehicle: 'Toyota Camry - ABC123',
          policyNumber: 'POL-123456',
          provider: 'State Farm',
          expiryDate: '2025-01-15',
          registrationNumber: 'REG-789012',
          registrationExpiry: '2025-03-30',
          status: 'active'
        },
        {
          vehicleId: 'XYZ789',
          vehicle: 'Honda CR-V - XYZ789',
          policyNumber: 'POL-234567',
          provider: 'Geico',
          expiryDate: '2024-12-20',
          registrationNumber: 'REG-890123',
          registrationExpiry: '2025-02-15',
          status: 'expiring-soon'
        },
        {
          vehicleId: 'DEF456',
          vehicle: 'Ford Focus - DEF456',
          policyNumber: 'POL-345678',
          provider: 'Progressive',
          expiryDate: '2025-06-10',
          registrationNumber: 'REG-901234',
          registrationExpiry: '2025-08-20',
          status: 'active'
        },
        {
          vehicleId: 'GHI345',
          vehicle: 'BMW X3 - GHI345',
          policyNumber: 'POL-456789',
          provider: 'Allstate',
          expiryDate: '2024-12-05',
          registrationNumber: 'REG-012345',
          registrationExpiry: '2024-12-25',
          status: 'expired'
        }
      ];

      // Sample inspection data
      const inspectionData = [
        {
          id: 'INS-001',
          vehicleId: 'ABC123',
          vehicle: 'Toyota Camry - ABC123',
          type: 'Pre-Rental',
          inspector: 'John Smith',
          date: '2024-12-10',
          status: 'completed',
          issuesFound: 0,
          bookingRef: 'BK001'
        },
        {
          id: 'INS-002',
          vehicleId: 'XYZ789',
          vehicle: 'Honda CR-V - XYZ789',
          type: 'Post-Return',
          inspector: 'Sarah Johnson',
          date: '2024-12-09',
          status: 'completed',
          issuesFound: 2,
          bookingRef: 'BK002'
        },
        {
          id: 'INS-003',
          vehicleId: 'DEF456',
          vehicle: 'Ford Focus - DEF456',
          type: 'Maintenance',
          inspector: 'Mike Davis',
          date: '2024-12-08',
          status: 'in-progress',
          issuesFound: 1,
          bookingRef: null
        }
      ];

      // Initialize page
      document.addEventListener('DOMContentLoaded', function() {
        populateServiceScheduleTable();
        populateInsuranceTable();
        populateInspectionsTable();
        populateInspectionTimeline();
      });

      function populateServiceScheduleTable() {
        const tbody = document.getElementById('serviceScheduleBody');
        tbody.innerHTML = '';

        serviceData.forEach(service => {
          const statusBadge = getServiceStatusBadge(service.status);
          const mileageStatus = service.currentMileage >= service.dueMileage ? 
            '<span class="text-danger">Due by mileage</span>' : 
            `${service.currentMileage}/${service.dueMileage}`;
          
          const row = `
            <tr onclick="viewServiceDetails('${service.vehicleId}')" style="cursor: pointer;">
              <td>
                <div class="fw-bold">${service.vehicle}</div>
                <small class="text-muted">Current: ${service.currentMileage.toLocaleString()} mi</small>
              </td>
              <td>
                <span class="fw-bold">${service.serviceType}</span>
                <div class="small text-muted">Est. cost: $${service.estimatedCost}</div>
              </td>
              <td>
                <div>${new Date(service.dueDate).toLocaleDateString()}</div>
                <small class="text-muted">${getDaysUntil(service.dueDate)} days</small>
              </td>
              <td>
                <div>${mileageStatus}</div>
              </td>
              <td>
                ${statusBadge}
                <div class="mt-1">${getPriorityBadge(service.priority)}</div>
              </td>
              <td>
                <div class="btn-group btn-group-sm">
                  <button class="btn btn-outline-primary" onclick="event.stopPropagation(); viewServiceDetails('${service.vehicleId}')" title="View Details">
                    <i class="fas fa-eye"></i>
                  </button>
                  <button class="btn btn-outline-success" onclick="event.stopPropagation(); markServiceCompleted('${service.vehicleId}')" title="Mark Complete">
                    <i class="fas fa-check"></i>
                  </button>
                  <button class="btn btn-outline-warning" onclick="event.stopPropagation(); rescheduleService('${service.vehicleId}')" title="Reschedule">
                    <i class="fas fa-calendar-alt"></i>
                  </button>
                </div>
              </td>
            </tr>
          `;
          tbody.innerHTML += row;
        });
      }

      function populateInsuranceTable() {
        const tbody = document.getElementById('insuranceTableBody');
        tbody.innerHTML = '';

        insuranceData.forEach(insurance => {
          const statusBadge = getInsuranceStatusBadge(insurance.status);
          const daysUntilExpiry = getDaysUntil(insurance.expiryDate);
          const daysUntilRegExpiry = getDaysUntil(insurance.registrationExpiry);
          
          const row = `
            <tr onclick="viewInsuranceDetails('${insurance.vehicleId}')" style="cursor: pointer;">
              <td>
                <div class="fw-bold">${insurance.vehicle}</div>
              </td>
              <td>
                <div class="fw-bold">${insurance.policyNumber}</div>
                <small class="text-muted">${insurance.provider}</small>
              </td>
              <td>
                <div class="fw-bold">${insurance.registrationNumber}</div>
                <small class="text-muted">Exp: ${new Date(insurance.registrationExpiry).toLocaleDateString()}</small>
              </td>
              <td>
                <div>${new Date(insurance.expiryDate).toLocaleDateString()}</div>
                <small class="text-muted">Registration: ${new Date(insurance.registrationExpiry).toLocaleDateString()}</small>
              </td>
              <td>${statusBadge}</td>
              <td>
                <div>Insurance: ${daysUntilExpiry} days</div>
                <small class="text-muted">Registration: ${daysUntilRegExpiry} days</small>
              </td>
              <td>
                <div class="btn-group btn-group-sm">
                  <button class="btn btn-outline-primary" onclick="event.stopPropagation(); viewInsuranceDetails('${insurance.vehicleId}')" title="View Details">
                    <i class="fas fa-eye"></i>
                  </button>
                  <button class="btn btn-outline-success" onclick="event.stopPropagation(); renewInsurance('${insurance.vehicleId}')" title="Renew">
                    <i class="fas fa-redo"></i>
                  </button>
                  <button class="btn btn-outline-warning" onclick="event.stopPropagation(); sendRenewalAlert('${insurance.vehicleId}')" title="Send Alert">
                    <i class="fas fa-bell"></i>
                  </button>
                </div>
              </td>
            </tr>
          `;
          tbody.innerHTML += row;
        });
      }

      function populateInspectionsTable() {
        const tbody = document.getElementById('inspectionsTableBody');
        tbody.innerHTML = '';

        inspectionData.forEach(inspection => {
          const statusBadge = getInspectionStatusBadge(inspection.status);
          const issuesBadge = inspection.issuesFound > 0 ? 
            `<span class="badge bg-warning">${inspection.issuesFound}</span>` : 
            `<span class="badge bg-success">None</span>`;
          
          const row = `
            <tr onclick="viewInspectionDetails('${inspection.id}')" style="cursor: pointer;">
              <td>
                <div class="fw-bold">${inspection.vehicle}</div>
                ${inspection.bookingRef ? `<small class="text-muted">Booking: ${inspection.bookingRef}</small>` : ''}
              </td>
              <td>
                <span class="fw-bold">${inspection.type}</span>
              </td>
              <td>${inspection.inspector}</td>
              <td>${new Date(inspection.date).toLocaleDateString()}</td>
              <td>${statusBadge}</td>
              <td>${issuesBadge}</td>
              <td>
                <div class="btn-group btn-group-sm">
                  <button class="btn btn-outline-primary" onclick="event.stopPropagation(); viewInspectionDetails('${inspection.id}')" title="View Details">
                    <i class="fas fa-eye"></i>
                  </button>
                  <button class="btn btn-outline-success" onclick="event.stopPropagation(); downloadInspectionReport('${inspection.id}')" title="Download Report">
                    <i class="fas fa-download"></i>
                  </button>
                  ${inspection.issuesFound > 0 ? `<button class="btn btn-outline-warning" onclick="event.stopPropagation(); viewDamageReport('${inspection.id}')" title="Damage Report"><i class="fas fa-exclamation-triangle"></i></button>` : ''}
                </div>
              </td>
            </tr>
          `;
          tbody.innerHTML += row;
        });
      }

      function populateInspectionTimeline() {
        const timeline = document.getElementById('inspectionTimeline');
        const recentInspections = inspectionData.slice(0, 5);
        
        timeline.innerHTML = recentInspections.map(inspection => `
          <div class="timeline-item">
            <div class="timeline-marker ${getTimelineColor(inspection.status)}"></div>
            <div class="timeline-content">
              <h6 class="mb-1">${inspection.type}</h6>
              <p class="text-muted mb-1">${inspection.vehicle}</p>
              <small class="text-muted">${new Date(inspection.date).toLocaleDateString()} - ${inspection.inspector}</small>
            </div>
          </div>
        `).join('');
      }

      function getServiceStatusBadge(status) {
        const badgeMap = {
          'due': 'bg-warning',
          'upcoming': 'bg-info',
          'overdue': 'bg-danger',
          'completed': 'bg-success'
        };
        const text = status.charAt(0).toUpperCase() + status.slice(1);
        return `<span class="badge ${badgeMap[status] || 'bg-secondary'}">${text}</span>`;
      }

      function getInsuranceStatusBadge(status) {
        const badgeMap = {
          'active': 'bg-success',
          'expiring-soon': 'bg-warning',
          'expired': 'bg-danger'
        };
        const text = status.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase());
        return `<span class="badge ${badgeMap[status] || 'bg-secondary'}">${text}</span>`;
      }

      function getInspectionStatusBadge(status) {
        const badgeMap = {
          'completed': 'bg-success',
          'in-progress': 'bg-info',
          'pending': 'bg-warning',
          'failed': 'bg-danger'
        };
        const text = status.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase());
        return `<span class="badge ${badgeMap[status] || 'bg-secondary'}">${text}</span>`;
      }

      function getPriorityBadge(priority) {
        const badgeMap = {
          'low': 'bg-success',
          'medium': 'bg-info',
          'high': 'bg-warning',
          'urgent': 'bg-danger'
        };
        const text = priority.charAt(0).toUpperCase() + priority.slice(1);
        return `<span class="badge ${badgeMap[priority] || 'bg-secondary'}">${text}</span>`;
      }

      function getTimelineColor(status) {
        const colorMap = {
          'completed': 'bg-success',
          'in-progress': 'bg-info',
          'pending': 'bg-warning',
          'failed': 'bg-danger'
        };
        return colorMap[status] || 'bg-secondary';
      }

      function getDaysUntil(dateString) {
        const today = new Date();
        const targetDate = new Date(dateString);
        const timeDiff = targetDate - today;
        const daysDiff = Math.ceil(timeDiff / (1000 * 60 * 60 * 24));
        return daysDiff;
      }

      function toggleSchedulingFields() {
        const basis = document.getElementById('schedulingBasis').value;
        const dateField = document.getElementById('dueDateField');
        const mileageField = document.getElementById('mileageField');

        if (basis === 'date') {
          dateField.style.display = 'block';
          mileageField.style.display = 'none';
        } else if (basis === 'mileage') {
          dateField.style.display = 'none';
          mileageField.style.display = 'block';
        } else if (basis === 'both') {
          dateField.style.display = 'block';
          mileageField.style.display = 'block';
        }
      }

      // Monitor radio button changes for damage assessment
      document.addEventListener('change', function(e) {
        if (e.target.name === 'exteriorCondition' || e.target.name === 'interiorCondition') {
          const damageReportBtn = document.getElementById('damageReportBtn');
          const exteriorCondition = document.querySelector('input[name="exteriorCondition"]:checked')?.value;
          const interiorCondition = document.querySelector('input[name="interiorCondition"]:checked')?.value;
          
          if (exteriorCondition !== 'good' || interiorCondition !== 'good') {
            damageReportBtn.style.display = 'inline-block';
          } else {
            damageReportBtn.style.display = 'none';
          }
        }
      });

      // Function implementations
      function scheduleService() {
        alert('Service scheduled successfully!');
        bootstrap.Modal.getInstance(document.getElementById('scheduleServiceModal')).hide();
        populateServiceScheduleTable();
      }

      function addInsuranceRecord() {
        alert('Insurance record added successfully!');
        bootstrap.Modal.getInstance(document.getElementById('addInsuranceModal')).hide();
        populateInsuranceTable();
      }

      function completePreInspection() {
        alert('Pre-rental inspection completed successfully!');
        bootstrap.Modal.getInstance(document.getElementById('preInspectionModal')).hide();
        populateInspectionsTable();
      }

      function completePostInspection() {
        alert('Post-return inspection completed successfully!');
        bootstrap.Modal.getInstance(document.getElementById('postInspectionModal')).hide();
        populateInspectionsTable();
      }

      function generateDamageReport() {
        alert('Damage report generated and saved to vehicle records.');
      }

      function applyServiceFilters() {
        console.log('Applying service filters...');
      }

      function applyInspectionFilters() {
        console.log('Applying inspection filters...');
      }

      function viewServiceDetails(vehicleId) {
        alert(`Viewing service details for vehicle ${vehicleId}`);
      }

      function markServiceCompleted(vehicleId) {
        if (confirm(`Mark service as completed for vehicle ${vehicleId}?`)) {
          alert('Service marked as completed!');
          populateServiceScheduleTable();
        }
      }

      function rescheduleService(vehicleId) {
        alert(`Rescheduling service for vehicle ${vehicleId}`);
      }

      function viewInsuranceDetails(vehicleId) {
        alert(`Viewing insurance details for vehicle ${vehicleId}`);
      }

      function renewInsurance(vehicleId) {
        alert(`Renewing insurance for vehicle ${vehicleId}`);
      }

      function sendRenewalAlert(vehicleId) {
        alert(`Renewal alert sent for vehicle ${vehicleId}`);
      }

      function viewInspectionDetails(inspectionId) {
        alert(`Viewing inspection details for ${inspectionId}`);
      }

      function downloadInspectionReport(inspectionId) {
        alert(`Downloading inspection report for ${inspectionId}`);
      }

      function viewDamageReport(inspectionId) {
        alert(`Viewing damage report for ${inspectionId}`);
      }

      function bulkServiceReminder() {
        alert('Service reminders sent to all due vehicles!');
      }

      function generateServiceReport() {
        alert('Service report generated!');
      }

      function scheduleMultipleServices() {
        alert('Bulk service scheduling interface would open here.');
      }

      function serviceSettings() {
        alert('Service settings interface would open here.');
      }

    </script>
  </body>
</html>
